System.register("chunks:///_virtual/AudioMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var u,e,i,t,s,c,n;return{setters:[function(o){u=o.createClass},function(o){e=o.cclegacy,i=o.AudioClip,t=o.assetManager,s=o.Node,c=o.director,n=o.AudioSource}],execute:function(){e._RF.push({},"d506fCKEkdMY7qkdZWU6ieq","AudioMgr",void 0),o("AudioMgr",function(){function o(){this._audioSource=void 0,this._musicVolume=1,this._musicVolumeScale=1,this._soundVolume=1;var o=new s;o.name="__audioMgr__",c.getScene().addChild(o),c.addPersistRootNode(o),this._audioSource=o.addComponent(n)}var e=o.prototype;return e.playOneShot=function(o,u,e){var s=this;(void 0===u&&(u=1),void 0===e&&(e="resources"),o instanceof i)?(this._audioSource.volume=1,this._audioSource.playOneShot(o,u*this._soundVolume)):t.getBundle(e).load(o,(function(o,e){o?console.log(o):(s._audioSource.volume=1,s._audioSource.playOneShot(e,u*s._soundVolume))}))},e.play=function(o,u,e){var s=this;(void 0===u&&(u=1),void 0===e&&(e="resources"),this._musicVolumeScale=u,o instanceof i)?(this._audioSource.stop(),this._audioSource.clip=o,this._audioSource.play(),this.audioSource.volume=this._musicVolume*this._musicVolumeScale):t.getBundle(e).load(o,(function(o,u){o?console.log(o):(s._audioSource.stop(),s._audioSource.clip=u,s._audioSource.play(),s.audioSource.volume=s._musicVolume*s._musicVolumeScale)}))},e.stop=function(){this._audioSource.stop()},e.pause=function(){this._audioSource.pause()},e.resume=function(){this._audioSource.play()},u(o,[{key:"audioSource",get:function(){return this._audioSource}},{key:"musicVolume",set:function(o){this._musicVolume=o,this._audioSource.volume=this._musicVolume*this._musicVolumeScale}},{key:"soundVolume",set:function(o){this._soundVolume=o}}],[{key:"inst",get:function(){return null==this._inst&&(this._inst=new o),this._inst}}]),o}())._inst=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterMovement.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EasyController.ts"],(function(i){var t,e,n,o,s,r,l,a,m,h,p,u,c,d,_,y,C;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,n=i.initializerDefineProperty,o=i.assertThisInitialized},function(i){s=i.cclegacy,r=i._decorator,l=i.v3,a=i.Camera,m=i.AnimationClip,h=i.find,p=i.RigidBody,u=i.Animation,c=i.Collider,d=i.Vec3,_=i.Component},function(i){y=i.EasyController,C=i.EasyControllerEvent}],execute:function(){var v,g,f,A,b,M,T,V,B,j,L,E,S,z,J,w,O,F;s._RF.push({},"d197aTs7v1GkpwypdJ1ezJ8","CharacterMovement",void 0);var P=r.ccclass,R=r.property,I=l();i("CharacterMovement",(v=P("tgxCharacterMovement"),g=R(a),f=R(m),A=R(m),b=R(m),M=R(m),T=R(m),v((j=t((B=function(i){function t(){for(var t,e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return t=i.call.apply(i,[this].concat(s))||this,n(t,"mainCamera",j,o(t)),n(t,"velocity",L,o(t)),n(t,"jumpVelocity",E,o(t)),n(t,"maxJumpTimes",S,o(t)),t._curJumpTimes=0,n(t,"idleAnimClip",z,o(t)),n(t,"moveAnimClip",J,o(t)),n(t,"jumpBeginAnimClip",w,o(t)),n(t,"jumpLoopAnimClip",O,o(t)),n(t,"jumpLandAnimClip",F,o(t)),t._rigidBody=void 0,t._isMoving=!1,t._velocityScale=1,t._isInTheAir=!1,t._currentVerticalVelocity=0,t._anim=void 0,t._tmp=l(),t}e(t,i);var s=t.prototype;return s.start=function(){var i,t=this;this.mainCamera||(this.mainCamera=null==(i=h("Main Camera"))?void 0:i.getComponent(a));if(this._rigidBody=this.node.getComponent(p),this._anim=this.node.getComponent(u),this._anim){for(var e=[this.idleAnimClip,this.moveAnimClip,this.jumpBeginAnimClip,this.jumpLoopAnimClip,this.jumpLandAnimClip],n=0;n<e.length;++n){var o=e[n];o&&(this._anim.getState(o.name)||this._anim.addClip(o))}this.idleAnimClip&&this._anim.play(this.idleAnimClip.name)}y.on(C.MOVEMENT,this.onMovement,this),y.on(C.MOVEMENT_STOP,this.onMovementRelease,this),y.on(C.BUTTON,this.onJump,this);var s=this.getComponent(c);null==s||s.on("onCollisionEnter",(function(i){i.otherCollider!=i.selfCollider&&t.onLand()}))},s.onDestroy=function(){y.off(C.MOVEMENT,this.onMovement,this),y.off(C.MOVEMENT_STOP,this.onMovementRelease,this),y.off(C.MOVEMENT_STOP,this.onJump,this)},s.update=function(i){if(this._isMoving&&(this._tmp.set(this.node.forward),this._tmp.multiplyScalar(-1),this._tmp.multiplyScalar(this.velocity*this._velocityScale),this._rigidBody?(this._rigidBody.getLinearVelocity(I),this._tmp.y=I.y,this._rigidBody.setLinearVelocity(this._tmp)):(this._tmp.multiplyScalar(i),this._tmp.add(this.node.position),this.node.setPosition(this._tmp))),this._isInTheAir){if(this.jumpBeginAnimClip&&this._anim){var t=this._anim.getState(this.jumpBeginAnimClip.name);t.isPlaying&&t.current>=t.duration&&this.jumpLoopAnimClip&&this._anim.crossFade(this.jumpLoopAnimClip.name)}if(!this._rigidBody){this._currentVerticalVelocity-=9.8*i;var e=this.node.position,n=e.y+this._currentVerticalVelocity*i;n<=0&&(this.onLand(),n=0),this.node.setPosition(e.x,n,e.z)}}},s.onLand=function(){this._isInTheAir=!1,this._currentVerticalVelocity=0,this._curJumpTimes=0,this.moveAnimClip&&(this._isMoving?this._anim.crossFade(this.moveAnimClip.name,.5):this._anim.crossFade(this.idleAnimClip.name,.5))},s.onMovement=function(i,t){var e=0;this.mainCamera&&(e=this.mainCamera.node.eulerAngles.y),this._velocityScale=t,this._tmp.set(0,e+i-90+180,0),this.node.setRotationFromEuler(this._tmp),this._anim&&(this._isMoving||this._isInTheAir||this.moveAnimClip&&this._anim.crossFade(this.moveAnimClip.name,.1),this.moveAnimClip&&(this._anim.getState(this.moveAnimClip.name).speed=this._velocityScale)),this._isMoving=!0},s.onMovementRelease=function(){var i;!this._isInTheAir&&this.idleAnimClip&&(null==(i=this._anim)||i.crossFade(this.idleAnimClip.name,.5));this._isMoving=!1,this._rigidBody&&this._rigidBody.setLinearVelocity(d.ZERO)},s.onJump=function(i){var t;(console.log(i),"btn_slot_0"==i)&&(this._curJumpTimes>=this.maxJumpTimes||(this._curJumpTimes,this.jumpBeginAnimClip&&(null==(t=this._anim)||t.crossFade(this.jumpBeginAnimClip.name)),this._curJumpTimes++,this._rigidBody?(this._rigidBody.getLinearVelocity(I),I.y=this.jumpVelocity,this._rigidBody.setLinearVelocity(I)):this._currentVerticalVelocity=this.jumpVelocity,this._isInTheAir=!0))},t}(_)).prototype,"mainCamera",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=t(B.prototype,"velocity",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),E=t(B.prototype,"jumpVelocity",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),S=t(B.prototype,"maxJumpTimes",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=t(B.prototype,"idleAnimClip",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=t(B.prototype,"moveAnimClip",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=t(B.prototype,"jumpBeginAnimClip",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=t(B.prototype,"jumpLoopAnimClip",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=t(B.prototype,"jumpLandAnimClip",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=B))||V));s._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterMovement2D.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EasyController.ts"],(function(t){var e,o,n,i,r,a,s,c,l,h,u,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.initializerDefineProperty,i=t.assertThisInitialized,r=t.createClass},function(t){a=t.cclegacy,s=t._decorator,c=t.v2,l=t.Vec2,h=t.Component},function(t){u=t.EasyController,v=t.EasyControllerEvent}],execute:function(){var m,p,f,M;a._RF.push({},"6bdfa3YMw1PwobXdjV+aWTX","CharacterMovement2D",void 0);var d=s.ccclass,y=s.property,_=c();t("CharacterMovement2D",d("tgxCharacterMovement2D")((f=e((p=function(t){function e(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"moveSpeed",f,i(e)),n(e,"needRotation",M,i(e)),e._moveFactor=0,e._moveDir=c(1,0),e}o(e,t);var a=e.prototype;return a.start=function(){u.on(v.MOVEMENT,this.onMovement,this),u.on(v.MOVEMENT_STOP,this.onMovementStop,this)},a.getRealSpeed=function(){return this.moveSpeed*this._moveFactor},a.onMovement=function(t,e){var o=t/180*Math.PI;this.needRotation&&this.node.setRotationFromEuler(0,0,t),this._moveDir.set(Math.cos(o),Math.sin(o)),this._moveDir.normalize(),this._moveFactor=e},a.onMovementStop=function(){this._moveFactor=0},a.onDestroy=function(){u.off(v.MOVEMENT,this.onMovement,this),u.off(v.MOVEMENT_STOP,this.onMovementStop,this)},a.update=function(t){if(this._moveFactor){l.multiplyScalar(_,this._moveDir,this.getRealSpeed()*t);var e=this.node.position;this.node.setPosition(e.x+_.x,e.y+_.y,e.z)}},r(e,[{key:"moveDir",get:function(){return this._moveDir}}]),e}(h)).prototype,"moveSpeed",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),M=e(p.prototype,"needRotation",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=p))||m);a._RF.pop()}}}));

System.register("chunks:///_virtual/client.ts",["cc"],(function(){var c;return{setters:[function(t){c=t.cclegacy}],execute:function(){c._RF.push({},"320c7MG6QhBqrPhMcbvPhTs","client",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/DoubleList.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e;return{setters:[function(t){i=t.createClass},function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"63d59pJTUFM04UKvbFs7rgg","DoubleList",void 0);var n=t("DoubleList",function(){function t(){this.head=null,this.tail=null}var e=t.prototype;return e.addToTail=function(t){var i=o.getFromPool(t,"dont_call_this_function_by_your_self");return this.addItemToTail(i),i},e.insertToHead=function(t){var i=o.getFromPool(t,"dont_call_this_function_by_your_self");return this.insertItemToHead(i),i},e.addItemToTail=function(t){if(t){if(t.isLinked)throw Error("item must be unlinked.");if(null==this.head)return this.head=this.tail=t,t.owner=this,t.pre=null,void(t.next=null);if(!this.tail)throw Error("tail can not be nil");this.tail.next=t,t.pre=this.tail,this.tail=t,t.owner=this}},e.insertItemToHead=function(t){if(t){if(t.isLinked)throw Error("item must be unlinked.");if(null==this.head)return this.head=this.tail=t,t.owner=this,t.pre=null,void(t.next=null);this.head.pre=t,t.next=this.head,t.owner=this,this.head=t}},e.forEach=function(t){if(t)for(var i=this.head;i;){var e=i.next;if(t(i))return;i=e}},e.clear=function(){this.forEach((function(t){t.dispose()}))},i(t,[{key:"isEmpty",get:function(){return null==this.head}}]),t}()),o=t("DoubleListItem",function(){function t(t,i){this.owner=null,this.pre=null,this.next=null,this.data=null,this.data=t}t.getFromPool=function(i,e){var n=this._itemPool.tail;return n?(n.removeSelf(),n.data=i,n):new t(i,"dont_call_this_function_by_your_self")},t.putBackToPool=function(t,i){t.removeSelf(),this._itemPool.addItemToTail(t)};var e=t.prototype;return e.dispose=function(){t.putBackToPool(this,"dont_call_this_function_by_your_self")},e.removeSelf=function(){this.owner&&(this.owner.head==this&&(this.owner.head=this.next),this.owner.tail==this&&(this.owner.tail=this.pre),this.pre&&(this.pre.next=this.next),this.next&&(this.next.pre=this.pre),this.owner=null,this.pre=null,this.next=null)},i(t,[{key:"isLinked",get:function(){return null!=this.owner}}]),t}());o._itemPool=new n,e._RF.pop()}}}));

System.register("chunks:///_virtual/EasyController.ts",["cc"],(function(n){var E,t;return{setters:[function(n){E=n.cclegacy,t=n.director}],execute:function(){E._RF.push({},"cc933ijiadBG47GZ61xXA52","EasyController",void 0);var e=n("EasyControllerEvent",(function(){}));e.CAMERA_ROTATE="EasyControllerEvent.CAMERA_ROTATE",e.CAMERA_ZOOM="EasyControllerEvent.CAMERA_ZOOM",e.MOVEMENT="EasyControllerEvent.MOVEMENT",e.MOVEMENT_STOP="EasyControllerEvent.MOVEMENT_STOP",e.BUTTON="EasyControllerEvent.BUTTON",e.SCREEN_TOUCH_START="EasyControllerEvent.SCREEN_TOUCH_START",e.SCREEN_TOUCH_END="EasyControllerEvent.SCREEN_TOUCH_END";n("EasyController",function(){function n(){}return n.on=function(n,E,e){t.getScene().on(n,E,e)},n.off=function(n,E,e){var o;null==(o=t.getScene())||o.off(n,E,e)},n}());E._RF.pop()}}}));

System.register("chunks:///_virtual/EventDef.ts",["cc"],(function(e){var E;return{setters:[function(e){E=e.cclegacy}],execute:function(){E._RF.push({},"5aad7wHcbFLpoHlMWGjXJZ6","EventDef",void 0);e("EventDef",function(e){return e.NODE_PROCESS="NODE_PROCESS",e.CHOICE_PROCESS="CHOICE_PROCESS",e.EFFECT_PROCESS="EFFECT_PROCESS",e}({}));E._RF.pop()}}}));

System.register("chunks:///_virtual/EventDispatcher.ts",["cc","./DoubleList.ts"],(function(t){var n,a;return{setters:[function(t){n=t.cclegacy},function(t){a=t.DoubleList}],execute:function(){n._RF.push({},"67acc++wNVNULP/OUgeuOW4","EventDispatcher",void 0);t("EventDispatcher",function(){function t(){this._handlersMap={}}var n=t.prototype;return n.on=function(t,n,e,r,i){if(t&&n){var s=this._handlersMap[t];s||(s=this._handlersMap[t]=new a),s.addToTail({event:t,cb:n,thisArg:e,once:i,args:r})}},n.once=function(t,n,a,e){this.on(t,n,a,e,!0)},n.off=function(t,n,a,e){var r=this._handlersMap[t];r&&r.forEach((function(t){var r=t.data;if(r.cb==n&&r.thisArg==a&&r.once==e)return t.dispose(),!0}))},n.clearAll=function(t){if(t){var n=this._handlersMap[t];null==n||n.clear(),delete this._handlersMap[t]}else{for(var a in this._handlersMap){var e=this._handlersMap[a];null==e||e.clear()}this._handlersMap={}}},n.emit=function(t,n,a,e,r,i){var s=this._handlersMap[t];if(s&&!s.isEmpty){var c=[n,a,e,r,i];s.forEach((function(n){var a=n.data;a.event==t&&a.cb.apply(a.thisArg,c)}))}},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/EventMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventDispatcher.ts"],(function(t){var n,e,i;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy},function(t){i=t.EventDispatcher}],execute:function(){e._RF.push({},"3885cai5npFVJfcdBbyYKMC","EventMgr",void 0),t("EventMgr",function(){function t(){this._eventDispatcher=void 0,this._eventDispatcher=new i}var e=t.prototype;return e.on=function(t,n,e,i,c){this._eventDispatcher.on(t,n,e,i,c)},e.emit=function(t,n,e,i,c,s){this._eventDispatcher.emit(t,n,e,i,c,s)},e.off=function(t,n,e,i){this._eventDispatcher.off(t,n,e,i)},e.once=function(t,n,e,i){this._eventDispatcher.once(t,n,e,i)},e.clearAll=function(t){this._eventDispatcher.clearAll(t)},n(t,null,[{key:"inst",get:function(){return null==this._inst&&(this._inst=new t),this._inst}}]),t}())._inst=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/FollowCamera2D.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,o,i,a,n,l,c,s,u;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,n=e._decorator,l=e.v3,c=e.Node,s=e.Camera,u=e.Component}],execute:function(){var p,f,d,g,h,m;a._RF.push({},"901c88RzPNC+KzYY4c1byNp","FollowCamera2D",void 0);var y=n.ccclass,v=n.property,b=l();e("FollowCamera2D",(p=y("tgxFollowCamera2D"),f=v(c),p((h=t((g=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return t=e.call.apply(e,[this].concat(a))||this,o(t,"target",h,i(t)),o(t,"offset",m,i(t)),t._camera=void 0,t}r(t,e);var a=t.prototype;return a.start=function(){this._camera=this.node.getComponent(s)},a.lateUpdate=function(e){this.target.getWorldPosition(b),b.add(this.offset),this.node.worldPosition=b},t}(u)).prototype,"target",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=t(g.prototype,"offset",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return l()}}),d=g))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/FPSCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,r,n,o;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy,n=t._decorator,o=t.Component}],execute:function(){var a;r._RF.push({},"35e79Dy4FRKopwoxbqfPUBI","FPSCamera",void 0);var c=n.ccclass;n.property,t("FPSCamera",c("tgxFPSCamera")(a=function(t){function r(){return t.apply(this,arguments)||this}e(r,t);var n=r.prototype;return n.start=function(){},n.update=function(t){},r}(o))||a);r._RF.pop()}}}));

System.register("chunks:///_virtual/FreeCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,o,s,n,r,h,a,p,d,_,c,l,u,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,o=e.initializerDefineProperty,s=e.assertThisInitialized},function(e){n=e.cclegacy,r=e._decorator,h=e.Vec2,a=e.Vec3,p=e.Quat,d=e.input,_=e.Input,c=e.game,l=e.KeyCode,u=e.v2,y=e.Component}],execute:function(){var E,v,K,Y,f,S,m,k;n._RF.push({},"9cfdbEnosdDcIV51/qKNoBS","FreeCamera",void 0);var D=r.ccclass,M=r.property,T=new h,P=new h,A=new a,g=new p,w=new a,W=new a;e("FreeCamera",(E=D("tgxFreeCamera"),v=M({slide:!0,range:[.05,.5,.01]}),E((f=t((Y=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return t=e.call.apply(e,[this].concat(n))||this,o(t,"moveSpeed",f,s(t)),o(t,"moveSpeedShiftScale",S,s(t)),o(t,"damp",m,s(t)),o(t,"rotateSpeed",k,s(t)),t._euler=new a,t._velocity=new a,t._position=new a,t._speedScale=1,t._eulerP=new a,t.keys=[],t.moveDir=new a,t.key2dirMap=null,t}i(t,e);var n=t.prototype;return n.onLoad=function(){d.on(_.EventType.MOUSE_WHEEL,this.onMouseWheel,this),d.on(_.EventType.TOUCH_START,this.onTouchStart,this),d.on(_.EventType.TOUCH_MOVE,this.onTouchMove,this),d.on(_.EventType.TOUCH_END,this.onTouchEnd,this),a.copy(this._euler,this.node.eulerAngles),a.copy(this._position,this.node.getPosition()),a.copy(this._eulerP,this.node.eulerAngles),d.on(_.EventType.KEY_DOWN,this.onKeyDown,this),d.on(_.EventType.KEY_UP,this.onKeyUp,this)},n.onDestroy=function(){d.off(_.EventType.MOUSE_WHEEL,this.onMouseWheel,this),d.off(_.EventType.TOUCH_START,this.onTouchStart,this),d.off(_.EventType.TOUCH_MOVE,this.onTouchMove,this),d.off(_.EventType.TOUCH_END,this.onTouchEnd,this),d.off(_.EventType.KEY_DOWN,this.onKeyDown,this),d.off(_.EventType.KEY_UP,this.onKeyUp,this)},n.update=function(e){var t=Math.min(e/this.damp,1);a.transformQuat(A,this._velocity,this.node.rotation),a.scaleAndAdd(this._position,this._position,A,this.moveSpeed*this._speedScale),a.lerp(A,this.node.getPosition(),this._position,t),this.node.setPosition(A),this.moveDir.lengthSqr()&&(a.transformQuat(w,a.FORWARD,this.node.rotation),w.normalize(),a.cross(W,w,a.UP),W.normalize(),a.scaleAndAdd(this._position,this._position,w,this.moveSpeed*this._speedScale*this.moveDir.z),a.lerp(A,this.node.getPosition(),this._position,t),this.node.setPosition(A),a.scaleAndAdd(this._position,this._position,W,this.moveSpeed*this._speedScale*this.moveDir.x),a.lerp(A,this.node.getPosition(),this._position,t),this.node.setPosition(A),a.scaleAndAdd(this._position,this._position,a.UP,this.moveSpeed*this._speedScale*this.moveDir.y),a.lerp(A,this.node.getPosition(),this._position,t),this.node.setPosition(A)),p.fromEuler(g,this._eulerP.x,this._eulerP.y,this._eulerP.z),p.slerp(g,this.node.rotation,g,t),this.node.setWorldRotationFromEuler(this._eulerP.x,this._eulerP.y,this._eulerP.z)},n.onMouseWheel=function(e){var t=-e.getScrollY()*this.moveSpeed*.1;a.transformQuat(A,a.UNIT_Z,this.node.rotation),a.scaleAndAdd(this._position,this.node.position,A,t)},n.onTouchStart=function(e){c.canvas.requestPointerLock&&c.canvas.requestPointerLock()},n.onTouchMove=function(e){e.getStartLocation(T),T.x,c.canvas.width,e.getDelta(P),this._eulerP.y-=P.x*this.rotateSpeed*.1,this._eulerP.x+=P.y*this.rotateSpeed*.1},n.onTouchEnd=function(e){document.exitPointerLock&&document.exitPointerLock(),e.getStartLocation(T),T.x<.4*c.canvas.width&&(this._velocity.x=0,this._velocity.z=0)},n.onKeyDown=function(e){var t=e.keyCode;t!=l.KEY_A&&t!=l.KEY_S&&t!=l.KEY_D&&t!=l.KEY_W||-1==this.keys.indexOf(t)&&(this.keys.push(t),this.updateDirection()),t==l.KEY_Q?this.moveDir.y=-1:t==l.KEY_E&&(this.moveDir.y=1)},n.onKeyUp=function(e){var t=e.keyCode;if(t==l.KEY_A||t==l.KEY_S||t==l.KEY_D||t==l.KEY_W){var i=this.keys.indexOf(t);-1!=i&&(this.keys.splice(i,1),this.updateDirection())}t!=l.KEY_Q&&t!=l.KEY_E||(this.moveDir.y=0)},n.updateDirection=function(){null==this.key2dirMap&&(this.key2dirMap={},this.key2dirMap[0]=u(0,0),this.key2dirMap[l.KEY_A]=u(-1,0),this.key2dirMap[l.KEY_D]=u(1,0),this.key2dirMap[l.KEY_W]=u(0,1),this.key2dirMap[l.KEY_S]=u(0,-1),this.key2dirMap[1e3*l.KEY_A+l.KEY_W]=this.key2dirMap[1e3*l.KEY_W+l.KEY_A]=u(-1,1),this.key2dirMap[1e3*l.KEY_D+l.KEY_W]=this.key2dirMap[1e3*l.KEY_W+l.KEY_D]=u(1,1),this.key2dirMap[1e3*l.KEY_A+l.KEY_S]=this.key2dirMap[1e3*l.KEY_S+l.KEY_A]=u(-1,-1),this.key2dirMap[1e3*l.KEY_D+l.KEY_S]=this.key2dirMap[1e3*l.KEY_S+l.KEY_D]=u(1,-1),this.key2dirMap[1e3*l.KEY_A+l.KEY_D]=this.key2dirMap[l.KEY_D],this.key2dirMap[1e3*l.KEY_D+l.KEY_A]=this.key2dirMap[l.KEY_A],this.key2dirMap[1e3*l.KEY_W+l.KEY_S]=this.key2dirMap[l.KEY_S],this.key2dirMap[1e3*l.KEY_S+l.KEY_W]=this.key2dirMap[l.KEY_W]);var e=this.keys[this.keys.length-1]||0,t=this.keys[this.keys.length-2]||0,i=this.key2dirMap[1e3*t+e];this.moveDir.x=i.x,this.moveDir.z=i.y},t}(y)).prototype,"moveSpeed",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),S=t(Y.prototype,"moveSpeedShiftScale",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),m=t(Y.prototype,"damp",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),k=t(Y.prototype,"rotateSpeed",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),K=Y))||K));n._RF.pop()}}}));

System.register("chunks:///_virtual/GameUILayers.ts",["cc"],(function(e){var a;return{setters:[function(e){a=e.cclegacy}],execute:function(){a._RF.push({},"a77a1B4SKRKLLPJCc2S/oq0","GameUILayers",void 0);var P=e("GameUILayers",function(e){return e[e.GAME=0]="GAME",e[e.JOY_STICK=1]="JOY_STICK",e[e.HUD=2]="HUD",e[e.POPUP=3]="POPUP",e[e.POPUP1=4]="POPUP1",e[e.POPUP2=5]="POPUP2",e[e.ALERT=6]="ALERT",e[e.NOTICE=7]="NOTICE",e[e.LOADING=8]="LOADING",e[e.OVERLAY=9]="OVERLAY",e[e.NUM=10]="NUM",e}(P||{}));e("GameUILayerNames",["game","joy_stick","hud","popup","popup1","popup2","alert","notice","loading","overlay"]);a._RF.pop()}}}));

System.register("chunks:///_virtual/InputMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var s,n;return{setters:[function(t){s=t.createClass},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"8fac4mBG8lPo5xB3wRNGThs","InputMgr",void 0),t("InputMgr",function(){function t(){this.STATE_NORMAL=1,this.STATE_KEEP=2,this._flags={},this._flagsMeta={}}var n=t.prototype;return n.setFlag=function(t,s,n){this._flags[t]=s?this.STATE_KEEP:this.STATE_NORMAL,null!=n&&(this._flagsMeta[t]=n)},n.removeFlag=function(t){delete this._flags[t]},n.hasFlag=function(t){return!!this._flags[t]},n.getMetaByFlag=function(t){return this._flagsMeta[t]},n.update=function(){for(var t in this._flags)this._flags[t]!=this.STATE_KEEP&&(this._flags[t]=0)},s(t,null,[{key:"inst",get:function(){return this._inst||(this._inst=new t),this._inst}}]),t}())._inst=null,n._RF.pop()}}}));

System.register("chunks:///_virtual/Layout_UIWaiting.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,e,n,r,o,a,l,c,u;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,n=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){o=i.cclegacy,a=i._decorator,l=i.Node,c=i.Label,u=i.Component}],execute:function(){var p,s,g,y,f,d,b;o._RF.push({},"cf096mKKypBc5BOy11i+5NG","Layout_UIWaiting",void 0);var _=a.ccclass,h=a.property;i("Layout_UIWaiting",(p=_("tgxLayout_UIWaiting"),s=h(l),g=h(c),p((d=t((f=function(i){function t(){for(var t,e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return t=i.call.apply(i,[this].concat(o))||this,n(t,"loadingIcon",d,r(t)),n(t,"loadingTxt",b,r(t)),t}return e(t,i),t}(u)).prototype,"loadingIcon",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=t(f.prototype,"loadingTxt",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=f))||y));o._RF.pop()}}}));

System.register("chunks:///_virtual/List.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env","./ListItem.ts"],(function(t){var e,i,s,o,n,a,l,r,c,h,_,d,u,m,p,g,f,v,I,y,T,S,w,z,D,N,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,s=t.initializerDefineProperty,o=t.assertThisInitialized,n=t.createClass},function(t){a=t.cclegacy,l=t._decorator,r=t.ScrollView,c=t.Enum,h=t.Node,_=t.Prefab,d=t.CCFloat,u=t.EventHandler,m=t.CCBoolean,p=t.CCInteger,g=t.isValid,f=t.UITransform,v=t.Layout,I=t.instantiate,y=t.NodePool,T=t.Vec3,S=t.Size,w=t.Widget,z=t.tween,D=t.Component},function(t){N=t.DEV},function(t){b=t.default}],execute:function(){var E,P,L,G,C,O,R,A,U,B,k,M,x,V,F,H,X,Y,Z,W,j,q,K,J,Q,$,tt,et,it,st,ot,nt,at,lt,rt,ct,ht,_t,dt,ut,mt,pt,gt;a._RF.push({},"1465aK3BeFERYvLMRafKnXR","List",void 0);var ft=l.ccclass,vt=l.property,It=l.disallowMultiple,yt=l.menu,Tt=l.executionOrder,St=l.requireComponent,wt=function(t){return t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB",t}(wt||{}),zt=function(t){return t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE",t}(zt||{}),Dt=function(t){return t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT",t}(Dt||{});t("default",(E=It(),P=yt("List"),L=St(r),G=Tt(-5e3),C=vt({type:c(wt),tooltip:N}),O=vt({type:h,tooltip:N,visible:function(){return this.templateType==wt.NODE}}),R=vt({type:_,tooltip:N,visible:function(){return this.templateType==wt.PREFAB}}),A=vt({}),U=vt({type:c(zt),tooltip:N}),B=vt({type:d,range:[0,1,.1],tooltip:N,slide:!0,visible:function(){return this._slideMode==zt.PAGE}}),k=vt({type:u,tooltip:N,visible:function(){return this._slideMode==zt.PAGE}}),M=vt({}),x=vt({type:m,tooltip:N}),V=vt({tooltip:N,visible:function(){var t=this.slideMode==zt.NORMAL;return t||(this.cyclic=!1),t}}),F=vt({tooltip:N,visible:function(){return this.virtual}}),H=vt({tooltip:N,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}}),X=vt({type:p}),Y=vt({type:p,range:[0,6,1],tooltip:N,slide:!0}),Z=vt({type:p,range:[0,12,1],tooltip:N,slide:!0}),W=vt({type:u,tooltip:N}),j=vt({type:c(Dt),tooltip:N}),q=vt({type:u,tooltip:N,visible:function(){return this.selectedMode>Dt.NONE}}),K=vt({tooltip:N,visible:function(){return this.selectedMode==Dt.SINGLE}}),J=vt({serializable:!1}),ft(Q=E(Q=P(Q=L(Q=G((tt=e(($=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,s(e,"templateType",tt,o(e)),s(e,"tmpNode",et,o(e)),s(e,"tmpPrefab",it,o(e)),s(e,"_slideMode",st,o(e)),s(e,"pageDistance",ot,o(e)),s(e,"pageChangeEvent",nt,o(e)),s(e,"_virtual",at,o(e)),s(e,"cyclic",lt,o(e)),s(e,"lackCenter",rt,o(e)),s(e,"lackSlide",ct,o(e)),s(e,"_updateRate",ht,o(e)),s(e,"frameByFrameRenderNum",_t,o(e)),s(e,"renderEvent",dt,o(e)),s(e,"selectedMode",ut,o(e)),s(e,"selectedEvent",mt,o(e)),s(e,"repeatEventSingle",pt,o(e)),e._selectedId=-1,e._lastSelectedId=void 0,e.multSelected=void 0,e._forceUpdate=!1,e._align=void 0,e._horizontalDir=void 0,e._verticalDir=void 0,e._startAxis=void 0,e._alignCalcType=void 0,e.content=void 0,e._contentUt=void 0,e.firstListId=void 0,e.displayItemNum=void 0,e._updateDone=!0,e._updateCounter=void 0,e._actualNumItems=void 0,e._cyclicNum=void 0,e._cyclicPos1=void 0,e._cyclicPos2=void 0,s(e,"_numItems",gt,o(e)),e._inited=!1,e._scrollView=void 0,e._layout=void 0,e._resizeMode=void 0,e._topGap=void 0,e._rightGap=void 0,e._bottomGap=void 0,e._leftGap=void 0,e._columnGap=void 0,e._lineGap=void 0,e._colLineNum=void 0,e._lastDisplayData=void 0,e.displayData=void 0,e._pool=void 0,e._itemTmp=void 0,e._itemTmpUt=void 0,e._needUpdateWidget=!1,e._itemSize=void 0,e._sizeType=void 0,e._customSize=void 0,e.frameCount=void 0,e._aniDelRuning=!1,e._aniDelCB=void 0,e._aniDelItem=void 0,e._aniDelBeforePos=void 0,e._aniDelBeforeScale=void 0,e.viewTop=void 0,e.viewRight=void 0,e.viewBottom=void 0,e.viewLeft=void 0,e._doneAfterUpdate=!1,e.elasticTop=void 0,e.elasticRight=void 0,e.elasticBottom=void 0,e.elasticLeft=void 0,e.scrollToListId=void 0,e.adhering=!1,e._adheringBarrier=!1,e.nearestListId=void 0,e.curPageNum=0,e._beganPos=void 0,e._scrollPos=void 0,e._curScrollIsTouch=void 0,e._scrollToListId=void 0,e._scrollToEndTime=void 0,e._scrollToSo=void 0,e._lack=void 0,e._allItemSize=void 0,e._allItemSizeNoEdge=void 0,e._scrollItem=void 0,e._thisNodeUt=void 0,e}i(e,t);var a=e.prototype;return a.onLoad=function(){this._init()},a.onDestroy=function(){var t=this;g(t._itemTmp)&&t._itemTmp.destroy(),g(t.tmpNode)&&t.tmpNode.destroy(),t._pool&&t._pool.clear()},a.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},a.onDisable=function(){this._unregisterEvent()},a._registerEvent=function(){var t=this;t.node.on(h.EventType.TOUCH_START,t._onTouchStart,t),t.node.on("touch-up",t._onTouchUp,t),t.node.on(h.EventType.TOUCH_CANCEL,t._onTouchCancelled,t),t.node.on("scroll-began",t._onScrollBegan,t),t.node.on("scroll-ended",t._onScrollEnded,t),t.node.on("scrolling",t._onScrolling,t),t.node.on(h.EventType.SIZE_CHANGED,t._onSizeChanged,t)},a._unregisterEvent=function(){var t=this;t.node.off(h.EventType.TOUCH_START,t._onTouchStart,t),t.node.off("touch-up",t._onTouchUp,t),t.node.off(h.EventType.TOUCH_CANCEL,t._onTouchCancelled,t),t.node.off("scroll-began",t._onScrollBegan,t),t.node.off("scroll-ended",t._onScrollEnded,t),t.node.off("scrolling",t._onScrolling,t),t.node.off(h.EventType.SIZE_CHANGED,t._onSizeChanged,t)},a._init=function(){var t=this;if(!t._inited)if(t._thisNodeUt=t.node.getComponent(f),t._scrollView=t.node.getComponent(r),t.content=t._scrollView.content,t._contentUt=t.content.getComponent(f),t.content){switch(t._layout=t.content.getComponent(v),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(I(t.templateType==wt.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=zt.ADHERING&&t._slideMode!=zt.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new y,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case v.Type.HORIZONTAL:switch(t._horizontalDir){case v.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case v.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case v.Type.VERTICAL:switch(t._verticalDir){case v.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case v.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case v.Type.GRID:switch(t._startAxis){case v.AxisDirection.HORIZONTAL:switch(t._verticalDir){case v.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case v.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case v.AxisDirection.VERTICAL:switch(t._horizontalDir){case v.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case v.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else console.error(t.node.name+"'s ScrollView unset content!")},a._processAutoScrolling=function(t){var e=1e-4,i=new T,s=this._scrollView,o=s._isNecessaryAutoScrollBrake(),n=o?.05:1;s._autoScrollAccumulatedTime+=t*(1/n);var a,l=Math.min(1,s._autoScrollAccumulatedTime/s._autoScrollTotalTime);s._autoScrollAttenuate&&(a=l,l=(a-=1)*a*a*a*a+1);var c=s._autoScrollTargetDelta.clone();c.multiplyScalar(l);var h=s._autoScrollStartPosition.clone();h.add(c);var _=Math.abs(l-1)<=e;if(Math.abs(l-1)<=s.getScrollEndedEventTiming()&&!s._isScrollEndedWithThresholdEventFired&&(s._dispatchEvent(r.EventType.SCROLL_ENG_WITH_THRESHOLD),s._isScrollEndedWithThresholdEventFired=!0),s.elastic){var d=h.clone();d.subtract(s._autoScrollBrakingStartPosition),o&&d.multiplyScalar(n),h.set(s._autoScrollBrakingStartPosition),h.add(d)}else{var u=h.clone();u.subtract(s._getContentPosition());var m=s._getHowMuchOutOfBoundary(u);m.equals(i,e)||(h.add(m),_=!0)}_&&(s._autoScrolling=!1);var p=new T(h);p.subtract(s._getContentPosition()),s._clampDelta(p),s._moveContent(p,_),s._dispatchEvent(r.EventType.SCROLLING),s._autoScrolling||(s._isBouncing=!1,s._scrolling=!1,s._dispatchEvent(r.EventType.SCROLL_ENDED))},a.setTemplateItem=function(t){if(t){var e=this;if(e._itemTmp=t,e._itemTmpUt=t.getComponent(f),e._resizeMode==v.ResizeMode.CHILDREN)e._itemSize=e._layout.cellSize;else{var i=t.getComponent(f);e._itemSize=new S(i.width,i.height)}var s=t.getComponent(b),o=!1;switch(s||(o=!0),o&&(e.selectedMode=Dt.NONE),(s=t.getComponent(w))&&s.enabled&&(e._needUpdateWidget=!0),e.selectedMode==Dt.MULT&&(e.multSelected=[]),e._align){case v.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case v.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case v.Type.GRID:switch(e._startAxis){case v.AxisDirection.HORIZONTAL:var n=e._contentUt.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((n+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case v.AxisDirection.VERTICAL:var a=e._contentUt.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((a+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},a.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&console.error("List initialization not completed!"),!1)},a._resizeContent=function(){var t,e=this;switch(e._align){case v.Type.HORIZONTAL:if(e._customSize){var i=e._getFixedSize(null);t=e._leftGap+i.val+e._itemSize.width*(e._numItems-i.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case v.Type.VERTICAL:if(e._customSize){var s=e._getFixedSize(null);t=e._topGap+s.val+e._itemSize.height*(e._numItems-s.count)+e._lineGap*(e._numItems-1)+e._bottomGap}else t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case v.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case v.AxisDirection.HORIZONTAL:var o=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*o+e._lineGap*(o-1)+e._bottomGap;break;case v.AxisDirection.VERTICAL:var n=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*n+e._columnGap*(n-1)+e._rightGap}}var a=e.content.getComponent(v);if(a&&(a.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var l=e._sizeType?e._thisNodeUt.height:e._thisNodeUt.width;e._cyclicPos1=0,l-=e._cyclicPos1,e._cyclicNum=Math.ceil(l/e._allItemSizeNoEdge)+1;var r=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+r,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+r*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=r*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e._thisNodeUt.height:e._thisNodeUt.width);var c=e._lack&&e.lackCenter||!e.lackSlide?.1:0,h=e._lack?(e._sizeType?e._thisNodeUt.height:e._thisNodeUt.width)-c:e.cyclic?e._cyclicAllItemSize:e._allItemSize;h<0&&(h=0),e._sizeType?e._contentUt.height=h:e._contentUt.width=h},a._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var i=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),s=this._sizeType?new T(0,i,0):new T(i,0,0),o=this.content.getPosition();switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(o.set(-this._cyclicPos2,o.y,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.subtract(s))):e<-this._cyclicPos2&&(o.set(-this._cyclicPos1,o.y,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(s)));break;case 2:e<this._cyclicPos1?(o.set(this._cyclicPos2,o.y,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(s))):e>this._cyclicPos2&&(o.set(this._cyclicPos1,o.y,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.subtract(s)));break;case 3:e<this._cyclicPos1?(o.set(o.x,this._cyclicPos2,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(s))):e>this._cyclicPos2&&(o.set(o.x,this._cyclicPos1,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.subtract(s)));break;case 4:e>-this._cyclicPos1?(o.set(o.x,-this._cyclicPos2,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.subtract(s))):e<-this._cyclicPos2&&(o.set(o.x,-this._cyclicPos1,o.z),this.content.setPosition(o),this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(s)))}}var n,a,l,r;if(this._calcViewPos(),this._sizeType?(n=this.viewTop,l=this.viewBottom):(a=this.viewRight,r=this.viewLeft),this._virtual){var c;this.displayData=[];var h=0,_=this._numItems-1;if(this._customSize)for(var d=!1;h<=_&&!d;h++)switch(c=this._calcItemPos(h),this._align){case v.Type.HORIZONTAL:c.right>=r&&c.left<=a?this.displayData.push(c):0!=h&&this.displayData.length>0&&(d=!0);break;case v.Type.VERTICAL:c.bottom<=n&&c.top>=l?this.displayData.push(c):0!=h&&this.displayData.length>0&&(d=!0);break;case v.Type.GRID:switch(this._startAxis){case v.AxisDirection.HORIZONTAL:c.bottom<=n&&c.top>=l?this.displayData.push(c):0!=h&&this.displayData.length>0&&(d=!0);break;case v.AxisDirection.VERTICAL:c.right>=r&&c.left<=a?this.displayData.push(c):0!=h&&this.displayData.length>0&&(d=!0)}}else{var u=this._itemSize.width+this._columnGap,m=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:h=(r-this._leftGap)/u,_=(a-this._leftGap)/u;break;case 2:h=(-a-this._rightGap)/u,_=(-r-this._rightGap)/u;break;case 3:h=(-n-this._topGap)/m,_=(-l-this._topGap)/m;break;case 4:h=(l-this._bottomGap)/m,_=(n-this._bottomGap)/m}for(h=Math.floor(h)*this._colLineNum,_=Math.ceil(_)*this._colLineNum,h<0&&(h=0),--_>=this._numItems&&(_=this._numItems-1);h<=_;h++)this.displayData.push(this._calcItemPos(h))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var p=this._lastDisplayData.length,g=this.displayItemNum!=p;if(g&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort((function(t,e){return t-e})),g=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[p-1]),this._forceUpdate||g)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var f=0;f<this.displayItemNum;f++)this._createOrUpdateItem(this.displayData[f]);this._forceUpdate=!1}this._calcNearestItem()}}},a._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this._thisNodeUt.width,this.elasticRight=this.viewRight>this._contentUt.width?Math.abs(this.viewRight-this._contentUt.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this._thisNodeUt.width,this.elasticLeft=this.viewLeft<-this._contentUt.width?Math.abs(this.viewLeft+this._contentUt.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this._thisNodeUt.height,this.elasticBottom=this.viewBottom<-this._contentUt.height?Math.abs(this.viewBottom+this._contentUt.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this._thisNodeUt.height,this.elasticTop=this.viewTop>this._contentUt.height?Math.abs(this.viewTop-this._contentUt.height):0,this.viewTop-=this.elasticTop}},a._calcItemPos=function(t){var e,i,s,o,n,a,l,r;switch(this._align){case v.Type.HORIZONTAL:switch(this._horizontalDir){case v.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var c=this._getFixedSize(t);n=this._leftGap+(this._itemSize.width+this._columnGap)*(t-c.count)+(c.val+this._columnGap*c.count);var h=this._customSize[t];e=h>0?h:this._itemSize.width}else n=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;if(this.lackCenter)n-=this._leftGap,n+=this._contentUt.width/2-this._allItemSizeNoEdge/2;return{id:t,left:n,right:a=n+e,x:n+this._itemTmpUt.anchorX*e,y:this._itemTmp.y};case v.HorizontalDirection.RIGHT_TO_LEFT:if(this._customSize){var _=this._getFixedSize(t);a=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-_.count)-(_.val+this._columnGap*_.count);var d=this._customSize[t];e=d>0?d:this._itemSize.width}else a=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;if(this.lackCenter)a+=this._rightGap,a-=this._contentUt.width/2-this._allItemSizeNoEdge/2;return{id:t,right:a,left:n=a-e,x:n+this._itemTmpUt.anchorX*e,y:this._itemTmp.y}}break;case v.Type.VERTICAL:switch(this._verticalDir){case v.VerticalDirection.TOP_TO_BOTTOM:if(this._customSize){var u=this._getFixedSize(t);s=-this._topGap-(this._itemSize.height+this._lineGap)*(t-u.count)-(u.val+this._lineGap*u.count);var m=this._customSize[t];i=m>0?m:this._itemSize.height}else s=-this._topGap-(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;if(this.lackCenter)s+=this._topGap,s-=this._contentUt.height/2-this._allItemSizeNoEdge/2;return{id:t,top:s,bottom:o=s-i,x:this._itemTmp.x,y:o+this._itemTmpUt.anchorY*i};case v.VerticalDirection.BOTTOM_TO_TOP:if(this._customSize){var p=this._getFixedSize(t);o=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-p.count)+(p.val+this._lineGap*p.count);var g=this._customSize[t];i=g>0?g:this._itemSize.height}else o=this._bottomGap+(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;if(this.lackCenter)o-=this._bottomGap,o+=this._contentUt.height/2-this._allItemSizeNoEdge/2;return{id:t,top:s=o+i,bottom:o,x:this._itemTmp.x,y:o+this._itemTmpUt.anchorY*i}}case v.Type.GRID:var f=Math.floor(t/this._colLineNum);switch(this._startAxis){case v.AxisDirection.HORIZONTAL:switch(this._verticalDir){case v.VerticalDirection.TOP_TO_BOTTOM:r=(o=(s=-this._topGap-(this._itemSize.height+this._lineGap)*f)-this._itemSize.height)+this._itemTmpUt.anchorY*this._itemSize.height;break;case v.VerticalDirection.BOTTOM_TO_TOP:s=(o=this._bottomGap+(this._itemSize.height+this._lineGap)*f)+this._itemSize.height,r=o+this._itemTmpUt.anchorY*this._itemSize.height}switch(l=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case v.HorizontalDirection.LEFT_TO_RIGHT:l+=this._itemTmpUt.anchorX*this._itemSize.width,l-=this._contentUt.anchorX*this._contentUt.width;break;case v.HorizontalDirection.RIGHT_TO_LEFT:l+=(1-this._itemTmpUt.anchorX)*this._itemSize.width,l-=(1-this._contentUt.anchorX)*this._contentUt.width,l*=-1}return{id:t,top:s,bottom:o,x:l,y:r};case v.AxisDirection.VERTICAL:switch(this._horizontalDir){case v.HorizontalDirection.LEFT_TO_RIGHT:a=(n=this._leftGap+(this._itemSize.width+this._columnGap)*f)+this._itemSize.width,l=n+this._itemTmpUt.anchorX*this._itemSize.width,l-=this._contentUt.anchorX*this._contentUt.width;break;case v.HorizontalDirection.RIGHT_TO_LEFT:l=(n=(a=-this._rightGap-(this._itemSize.width+this._columnGap)*f)-this._itemSize.width)+this._itemTmpUt.anchorX*this._itemSize.width,l+=(1-this._contentUt.anchorX)*this._contentUt.width}switch(r=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case v.VerticalDirection.TOP_TO_BOTTOM:r-=(1-this._itemTmpUt.anchorY)*this._itemSize.height,r+=(1-this._contentUt.anchorY)*this._contentUt.height;break;case v.VerticalDirection.BOTTOM_TO_TOP:r-=this._itemTmpUt.anchorY*this._itemSize.height,r+=this._contentUt.anchorY*this._contentUt.height,r*=-1}return{id:t,left:n,right:a,x:l,y:r}}}},a._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var i=e.getComponent(f),s=e.getPosition(),o={id:t,x:s.x,y:s.y};return this._sizeType?(o.top=s.y+i.height*(1-i.anchorY),o.bottom=s.y-i.height*i.anchorY):(o.left=s.x-i.width*i.anchorX,o.right=s.x+i.width*(1-i.anchorX)),o},a.getItemPos=function(t){return this._virtual||this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},a._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,i=0;for(var s in this._customSize)parseInt(s)<t&&(e+=this._customSize[s],i++);return{val:e,count:i}},a._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},a._onScrollEnded=function(){var t=this;if(t._curScrollIsTouch=!1,null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&z(e).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}t._onScrolling(),t._slideMode!=zt.ADHERING||t.adhering?t._slideMode==zt.PAGE&&(null!=t._beganPos&&t._curScrollIsTouch?this._pageAdhere():t.adhere()):t.adhere()},a._onTouchStart=function(t,e){if(!this._scrollView._hasNestedViewGroup(t,e)&&(this._curScrollIsTouch=!0,!(t.eventPhase===Event.AT_TARGET&&t.target===this.node))){for(var i=t.target;null==i._listId&&i.parent;)i=i.parent;this._scrollItem=null!=i._listId?i:t.target}},a._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==zt.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==zt.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},a._onTouchCancelled=function(t,e){var i=this;i._scrollView._hasNestedViewGroup(t,e)||t.simulate||(i._scrollPos=null,i._slideMode==zt.ADHERING?(i.adhering&&(i._adheringBarrier=!0),i.adhere()):i._slideMode==zt.PAGE&&(null!=i._beganPos?i._pageAdhere():i.adhere()),this._scrollItem=null)},a._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},a._onItemAdaptive=function(t){var e=t.getComponent(f);if(!this._sizeType&&e.width!=this._itemSize.width||this._sizeType&&e.height!=this._itemSize.height){this._customSize||(this._customSize={});var i=this._sizeType?e.height:e.width;this._customSize[t._listId]!=i&&(this._customSize[t._listId]=i,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},a._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,i=(t._sizeType?t._thisNodeUt.height:t._thisNodeUt.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>i){var s=.5;switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(s):t.nextPage(s);break;case 2:case 3:t._beganPos<e?t.prePage(s):t.nextPage(s)}}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},a.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t._thisNodeUt.height:t._thisNodeUt.width);t.scrollTo(t.nearestListId,.7,e)}},a.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var i=this.displayData[e];i&&this._createOrUpdateItem(i)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==zt.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(var s=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,o=this._updateCounter;o<s;o++)this._createOrUpdateItem2(o);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==zt.PAGE&&(this.curPageNum=this.nearestListId)},a._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(new T(t.x,t.y,0)),this._resetItemSize(e),this.renderEvent&&u.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var i=this._pool.size()>0;if(e=i?this._pool.get():I(this._itemTmp),i&&g(e)||(e=I(this._itemTmp),i=!1),e._listId!=t.id)e._listId=t.id,e.getComponent(f).setContentSize(this._itemSize);if(e.setPosition(new T(t.x,t.y,0)),this._resetItemSize(e),this.content.addChild(e),i&&this._needUpdateWidget){var s=e.getComponent(w);s&&s.updateAlignment()}e.setSiblingIndex(this.content.children.length-1);var o=e.getComponent(b);e.listItem=o,o&&(o.listId=t.id,o.list=this,o._registerEvent()),this.renderEvent&&u.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},a._createOrUpdateItem2=function(t){var e,i=this.content.children[t];i?this._forceUpdate&&this.renderEvent&&(i._listId=t,e&&(e.listId=t),this.renderEvent&&u.emitEvents([this.renderEvent],i,t%this._actualNumItems)):((i=I(this._itemTmp))._listId=t,this.content.addChild(i),e=i.getComponent(b),i.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&u.emitEvents([this.renderEvent],i,t%this._actualNumItems)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},a._updateListItem=function(t){if(t&&this.selectedMode>Dt.NONE){var e=t.node;switch(this.selectedMode){case Dt.SINGLE:t.selected=this.selectedId==e._listId;break;case Dt.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},a._resetItemSize=function(t){},a._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),i=this.getItemPos(e._listId);e.setPosition(i.x,i.y)},a.setMultSelected=function(t,e){var i=this;if(i.checkInited()){var s,o;if(Array.isArray(t)||(t=[t]),null==e)i.multSelected=t;else if(e)for(var n=t.length-1;n>=0;n--)s=t[n],(o=i.multSelected.indexOf(s))<0&&i.multSelected.push(s);else for(var a=t.length-1;a>=0;a--)s=t[a],(o=i.multSelected.indexOf(s))>=0&&i.multSelected.splice(o,1);i._forceUpdate=!0,i._onScrolling()}},a.getMultSelected=function(){return this.multSelected},a.hasMultSelected=function(t){return this.multSelected&&this.multSelected.indexOf(t)>=0},a.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,i=t.length;e<i;e++){var s=t[e],o=this.getItemByListId(s);o&&u.emitEvents([this.renderEvent],o,s%this._actualNumItems)}}},a.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},a.getItemByListId=function(t){if(this.content)for(var e=this.content.children.length-1;e>=0;e--){var i=this.content.children[e];if(i._listId==t)return i}},a._getOutsideItem=function(){for(var t,e=[],i=this.content.children.length-1;i>=0;i--)t=this.content.children[i],this.displayData.find((function(e){return e.id==t._listId}))||e.push(t);return e},a._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var i=t[e];if(!this._scrollItem||i._listId!=this._scrollItem._listId){i.isCached=!0,this._pool.put(i);for(var s=this._lastDisplayData.length-1;s>=0;s--)if(this._lastDisplayData[s]==i._listId){this._lastDisplayData.splice(s,1);break}}}else for(;this.content.children.length>this._numItems;)this._delSingleItem(this.content.children[this.content.children.length-1])},a._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},a.aniDelItem=function(t,e,i){var s=this;if(!s.checkInited()||s.cyclic||!s._virtual)return console.error("This function is not allowed to be called!");if(!e)return console.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(s._aniDelRuning)return console.warn("Please wait for the current deletion to finish!");var o,n=s.getItemByListId(t);if(n){o=n.getComponent(b),s._aniDelRuning=!0,s._aniDelCB=e,s._aniDelItem=n,s._aniDelBeforePos=n.position,s._aniDelBeforeScale=n.scale;var a=s.displayData[s.displayData.length-1].id,l=o.selected;o.showAni(i,(function(){var i;if(a<s._numItems-2&&(i=a+1),null!=i){var o=s._calcItemPos(i);s.displayData.push(o),s._virtual?s._createOrUpdateItem(o):s._createOrUpdateItem2(i)}else s._numItems--;if(s.selectedMode==Dt.SINGLE)l?s._selectedId=-1:s._selectedId-1>=0&&s._selectedId--;else if(s.selectedMode==Dt.MULT&&s.multSelected.length){var r=s.multSelected.indexOf(t);r>=0&&s.multSelected.splice(r,1);for(var c=s.multSelected.length-1;c>=0;c--){s.multSelected[c]>=t&&s.multSelected[c]--}}if(s._customSize){s._customSize[t]&&delete s._customSize[t];var h,_={};for(var d in s._customSize){h=s._customSize[d];var u=parseInt(d);_[u-(u>=t?1:0)]=h}s._customSize=_}for(var m,p,g=null!=i?i:a;g>=t+1;g--)if(n=s.getItemByListId(g)){var f=s._calcItemPos(g-1);m=z(n).to(.2333,{position:new T(f.x,f.y,0)}),g<=t+1&&(p=!0,m.call((function(){s._aniDelRuning=!1,e(t),delete s._aniDelCB}))),m.start()}p||(s._aniDelRuning=!1,e(t),s._aniDelCB=null)}),!0)}else e(t)},a.scrollTo=function(t,e,i,s){void 0===e&&(e=.5),void 0===i&&(i=null),void 0===s&&(s=!1);var o=this;if(o.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=o._numItems&&(t=o._numItems-1),!o._virtual&&o._layout&&o._layout.enabled&&o._layout.updateLayout();var n,a,l=o.getItemPos(t);if(!l)return N;switch(o._alignCalcType){case 1:n=l.left,n-=null!=i?o._thisNodeUt.width*i:o._leftGap,l=new T(n,0,0);break;case 2:n=l.right-o._thisNodeUt.width,n+=null!=i?o._thisNodeUt.width*i:o._rightGap,l=new T(n+o._contentUt.width,0,0);break;case 3:a=l.top,a+=null!=i?o._thisNodeUt.height*i:o._topGap,l=new T(0,-a,0);break;case 4:a=l.bottom+o._thisNodeUt.height,a-=null!=i?o._thisNodeUt.height*i:o._bottomGap,l=new T(0,-a+o._contentUt.height,0)}var r=o.content.getPosition();r=Math.abs(o._sizeType?r.y:r.x);var c=o._sizeType?l.y:l.x;Math.abs((null!=o._scrollPos?o._scrollPos:r)-c)>.5&&(o._scrollView.scrollToOffset(l,e),o._scrollToListId=t,o._scrollToEndTime=(new Date).getTime()/1e3+e,o._scrollToSo=o.scheduleOnce((function(){if(o._adheringBarrier||(o.adhering=o._adheringBarrier=!1),o._scrollPos=o._scrollToListId=o._scrollToEndTime=o._scrollToSo=null,s){var e=o.getItemByListId(t);e&&z(e).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}}),e+.1),e<=0&&o._onScrolling())}},a._calcNearestItem=function(){var t,e,i,s,o,n,a=this;a.nearestListId=null,a._virtual&&a._calcViewPos(),i=a.viewTop,s=a.viewRight,o=a.viewBottom,n=a.viewLeft;for(var l=!1,r=0;r<a.content.children.length&&!l;r+=a._colLineNum)if(t=a._virtual?a.displayData[r]:a._calcExistItemPos(r))switch(e=a._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,a._alignCalcType){case 1:t.right>=n&&(a.nearestListId=t.id,n>e&&(a.nearestListId+=a._colLineNum),l=!0);break;case 2:t.left<=s&&(a.nearestListId=t.id,s<e&&(a.nearestListId+=a._colLineNum),l=!0);break;case 3:t.bottom<=i&&(a.nearestListId=t.id,i<e&&(a.nearestListId+=a._colLineNum),l=!0);break;case 4:t.top>=o&&(a.nearestListId=t.id,o>e&&(a.nearestListId+=a._colLineNum),l=!0)}if((t=a._virtual?a.displayData[a.displayItemNum-1]:a._calcExistItemPos(a._numItems-1))&&t.id==a._numItems-1)switch(e=a._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,a._alignCalcType){case 1:s>e&&(a.nearestListId=t.id);break;case 2:n<e&&(a.nearestListId=t.id);break;case 3:o<e&&(a.nearestListId=t.id);break;case 4:i>e&&(a.nearestListId=t.id)}},a.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},a.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},a.skipPage=function(t,e){var i=this;if(i.checkInited())return i._slideMode!=zt.PAGE?console.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=i._numItems||i.curPageNum!=t&&(i.curPageNum=t,i.pageChangeEvent&&u.emitEvents([i.pageChangeEvent],t),i.scrollTo(t,e)))},a.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return console.error("Unset template item!");if(!e.renderEvent)return console.error("Unset Render-Event!");e._customSize={};var i=I(e._itemTmp),s=i.getComponent(f);e.content.addChild(i);for(var o=0;o<t;o++)u.emitEvents([e.renderEvent],i,o),s.height==e._itemSize.height&&s.width==e._itemSize.width||(e._customSize[o]=e._sizeType?s.height:s.width);return Object.keys(e._customSize).length||(e._customSize=null),i.removeFromParent(),i.destroy&&i.destroy(),e._customSize}},n(e,[{key:"slideMode",get:function(){return this._slideMode},set:function(t){this._slideMode=t}},{key:"virtual",get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()}},{key:"updateRate",get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)}},{key:"selectedId",get:function(){return this._selectedId},set:function(t){var e,i=this;switch(i.selectedMode){case Dt.SINGLE:if(!i.repeatEventSingle&&t==i._selectedId)return;if(e=i.getItemByListId(t),i._selectedId>=0?i._lastSelectedId=i._selectedId:i._lastSelectedId=null,i._selectedId=t,e&&(e.getComponent(b).selected=!0),i._lastSelectedId>=0&&i._lastSelectedId!=i._selectedId){var s=i.getItemByListId(i._lastSelectedId);s&&(s.getComponent(b).selected=!1)}i.selectedEvent&&u.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems);break;case Dt.MULT:if(!(e=i.getItemByListId(t)))return;var o=e.getComponent(b);i._selectedId>=0&&(i._lastSelectedId=i._selectedId),i._selectedId=t;var n=!o.selected;o.selected=n;var a=i.multSelected.indexOf(t);n&&a<0?i.multSelected.push(t):!n&&a>=0&&i.multSelected.splice(a,1),i.selectedEvent&&u.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems,n)}}},{key:"numItems",get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)console.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=zt.PAGE||(e.curPageNum=e.nearestListId);else{e.cyclic&&(e._resizeContent(),e._numItems=e._cyclicNum*e._numItems);var i=e.content.getComponent(v);if(i&&(i.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var s=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,o=0;o<s;o++)e._createOrUpdateItem2(o);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(var n=0;n<e._numItems;n++)e._createOrUpdateItem2(n);e.displayItemNum=e._numItems}}}},{key:"scrollView",get:function(){return this._scrollView}}]),e}(D)).prototype,"templateType",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return wt.NODE}}),et=e($.prototype,"tmpNode",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=e($.prototype,"tmpPrefab",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=e($.prototype,"_slideMode",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return zt.NORMAL}}),e($.prototype,"slideMode",[U],Object.getOwnPropertyDescriptor($.prototype,"slideMode"),$.prototype),ot=e($.prototype,"pageDistance",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),nt=e($.prototype,"pageChangeEvent",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u}}),at=e($.prototype,"_virtual",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),e($.prototype,"virtual",[x],Object.getOwnPropertyDescriptor($.prototype,"virtual"),$.prototype),lt=e($.prototype,"cyclic",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),rt=e($.prototype,"lackCenter",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ct=e($.prototype,"lackSlide",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ht=e($.prototype,"_updateRate",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e($.prototype,"updateRate",[Y],Object.getOwnPropertyDescriptor($.prototype,"updateRate"),$.prototype),_t=e($.prototype,"frameByFrameRenderNum",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),dt=e($.prototype,"renderEvent",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u}}),ut=e($.prototype,"selectedMode",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Dt.NONE}}),mt=e($.prototype,"selectedEvent",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u}}),pt=e($.prototype,"repeatEventSingle",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gt=e($.prototype,"_numItems",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Q=$))||Q)||Q)||Q)||Q)||Q));a._RF.pop()}}}));

System.register("chunks:///_virtual/ListItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./env"],(function(e){var t,i,n,o,s,r,a,l,c,d,u,p,h,f,m,g,v,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.createClass},function(e){r=e.cclegacy,a=e._decorator,l=e.Enum,c=e.Node,d=e.SpriteFrame,u=e.Sprite,p=e.EventHandler,h=e.UITransform,f=e.tween,m=e.Vec3,g=e.Button,v=e.Component},function(e){b=e.DEV}],execute:function(){var y,C,_,S,w,E,I,F,N,T,k,z,D;r._RF.push({},"e7dc6ZAYPVLJKxNcW8aTO1J","ListItem",void 0);var L=a.ccclass,H=a.property,M=a.disallowMultiple,O=a.menu,G=a.executionOrder,A=function(e){return e[e.NONE=0]="NONE",e[e.TOGGLE=1]="TOGGLE",e[e.SWITCH=2]="SWITCH",e}(A||{});e("default",(y=M(),C=O("List Item"),_=G(-5001),S=H({type:l(A),tooltip:b}),w=H({type:c,tooltip:b,visible:function(){return this.selectedMode>A.NONE}}),E=H({type:d,tooltip:b,visible:function(){return this.selectedMode==A.SWITCH}}),I=H({tooltip:b}),L(F=y(F=C(F=_((T=t((N=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,n(t,"selectedMode",T,o(t)),n(t,"selectedFlag",k,o(t)),n(t,"selectedSpriteFrame",z,o(t)),t._unselectedSpriteFrame=null,n(t,"adaptiveSize",D,o(t)),t._selected=!1,t._btnCom=void 0,t.list=void 0,t._eventReg=!1,t.listId=void 0,t}i(t,e);var r=t.prototype;return r.onLoad=function(){if(this.selectedMode==A.SWITCH){var e=this.selectedFlag.getComponent(u);this._unselectedSpriteFrame=e.spriteFrame}},r.onDestroy=function(){this.node.off(c.EventType.SIZE_CHANGED,this._onSizeChange,this)},r._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(c.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},r._onSizeChange=function(){this.list._onItemAdaptive(this.node)},r.createEvt=function(e,t,i){if(void 0===i&&(i=null),e.isValid){e.comName=e.comName||e.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var n=new p;return n.target=i||e.node,n.component=e.comName,n.handler=t,n}},r.showAni=function(e,t,i){var n,o=this,s=o.node.getComponent(h);switch(e){case 0:n=f(o.node).to(.2,{scale:new m(.7,.7)}).by(.3,{position:new m(0,2*s.height)});break;case 1:n=f(o.node).to(.2,{scale:new m(.7,.7)}).by(.3,{position:new m(2*s.width,0)});break;case 2:n=f(o.node).to(.2,{scale:new m(.7,.7)}).by(.3,{position:new m(0,-2*s.height)});break;case 3:n=f(o.node).to(.2,{scale:new m(.7,.7)}).by(.3,{position:new m(-2*s.width,0)});break;default:n=f(o.node).to(.3,{scale:new m(.1,.1)})}(t||i)&&n.call((function(){if(i){o.list._delSingleItem(o.node);for(var e=o.list.displayData.length-1;e>=0;e--)if(o.list.displayData[e].id==o.listId){o.list.displayData.splice(e,1);break}}t()})),n.start()},r.onClickThis=function(){this.list.selectedId=this.listId},s(t,[{key:"selected",get:function(){return this._selected},set:function(e){if(this._selected=e,this.selectedFlag)switch(this.selectedMode){case A.TOGGLE:this.selectedFlag.active=e;break;case A.SWITCH:var t=this.selectedFlag.getComponent(u);t&&(t.spriteFrame=e?this.selectedSpriteFrame:this._unselectedSpriteFrame)}}},{key:"btnCom",get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(g)),this._btnCom}}]),t}(v)).prototype,"selectedMode",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return A.NONE}}),k=t(N.prototype,"selectedFlag",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(N.prototype,"selectedSpriteFrame",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(N.prototype,"adaptiveSize",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),F=N))||F)||F)||F)||F));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AudioMgr.ts","./DoubleList.ts","./InputMgr.ts","./ModuleContext.ts","./ResolutionAutoFit.ts","./ResourceMgr.ts","./SafeJSON.ts","./SceneUtils.ts","./URLUtils.ts","./FPSCamera.ts","./FollowCamera2D.ts","./FreeCamera.ts","./ThirdPersonCamera.ts","./CharacterMovement.ts","./CharacterMovement2D.ts","./EasyController.ts","./ThirdPersonCameraCtrl.ts","./UIJoystick.ts","./client.ts","./EventDispatcher.ts","./EventMgr.ts","./UIController.ts","./UILayers.ts","./UIMgr.ts","./UIAlert.ts","./Layout_UIWaiting.ts","./UIWaiting.ts","./tgx.ts","./List.ts","./ListItem.ts","./UI_ChatItem.ts","./UI_Game.ts","./StoryManager.ts","./EventDef.ts","./Story.ts","./StoryDef.ts","./UIDef2.ts","./UI_EndFlag.ts","./UI_HostDialogue.ts","./UI_PlayerChoice.ts","./UI_PlayerDialogue.ts","./UI_SystemAcrion.ts","./UI_SystemMesage.ts","./GameUILayers.ts","./ModuleDef.ts","./SceneDef.ts","./UIDef.ts","./Start.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/ModuleContext.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"5575a3VV2RD746hi1OU1Xsj","ModuleContext",void 0);var n="__module__name__",u="resources";t("ModuleContext",function(){function t(){}return t.setDefaultModule=function(t){u=t},t.getDefaultModule=function(){return u},t.attachClassModule=function(t,e){t[n]=e},t.getClassModule=function(t){return t[n]||u},t.attachImplClass=function(t,e){t.__impl__class__=e},t.attachModuleAndImplClass=function(t,e,u){t[n]=e,t.__impl__class__=u},t.getImplClass=function(t){return t.__impl__class__||t},t.createFromModule=function(t){return new(this.getImplClass(t)||t)},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/ModuleDef.ts",["cc"],(function(e){var o;return{setters:[function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"6cdc84XjYpIJZs1++qgwn4Z","ModuleDef",void 0);var u=e("ModuleDef",(function(){}));u.BASIC="module_basic",u.HALL="module_hall",u.DEMO_ROOSTER="module_demo_rooster",u.DEMO_TANK="module_demo_tank",u.EXTRA="module_extra",u.GAME_MINE_SWEEPER="module_game_mine_sweeper",o._RF.pop()}}}));

System.register("chunks:///_virtual/ResolutionAutoFit.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,o,e,s,n,u,l,c;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,s=t.screen,n=t.view,u=t.ResolutionPolicy,l=t.size,c=t.Component}],execute:function(){var r;o._RF.push({},"e5d8aIjX9NO3ox3KMWTDbsA","ResolutionAutoFit",void 0);var a=e.ccclass;e.property,t("ResolutionAutoFit",a("tgxResolutionAutoFit")(r=function(t){function o(){for(var i,o=arguments.length,e=new Array(o),s=0;s<o;s++)e[s]=arguments[s];return(i=t.call.apply(t,[this].concat(e))||this)._oldSize=l(),i.lastCheckTime=0,i}i(o,t);var e=o.prototype;return e.start=function(){this.adjustResolutionPolicy()},e.update=function(t){this.lastCheckTime+=t,this.lastCheckTime<.1||(this.lastCheckTime=0,this.adjustResolutionPolicy())},e.adjustResolutionPolicy=function(){var t=s.windowSize;if(!this._oldSize.equals(t)){var i=t.width/t.height,o=n.getDesignResolutionSize();i>o.width/o.height?n.setResolutionPolicy(u.FIXED_HEIGHT):n.setResolutionPolicy(u.FIXED_WIDTH),this._oldSize.set(t)}},o}(c))||r);o._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,i;return{setters:[function(e){n=e.createClass},function(e){t=e.cclegacy,i=e.resources}],execute:function(){t._RF.push({},"b666cLPxptFbq3Cc9VNNPIW","ResourceMgr",void 0);var r=function(){this.url=void 0,this.isLoading=!1,this.callbackArr=[]};e("ResourceMgr",function(){function e(){this.loadingQueue=[]}return e.prototype.loadRes=function(e,n,t){var u=this,s=i.get(e,n);if(s)t&&setTimeout((function(){t(null,s)}),10);else{var o=this.loadingQueue[e];o||((o=this.loadingQueue[e]=new r).url=e),o.callbackArr.push(t),o.isLoading||(o.isLoading=!0,i.load(e,n,(function(n,t){for(var i in delete u.loadingQueue[e],o.callbackArr){var r=o.callbackArr[i];r&&r(n,t)}})))}},n(e,null,[{key:"inst",get:function(){return this._inst||(this._inst=new e),this._inst}}]),e}())._inst=null,t._RF.pop()}}}));

System.register("chunks:///_virtual/SafeJSON.ts",["cc"],(function(t){var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"2aad8l/WzBPTIhr1W6SB9Pt","SafeJSON",void 0);t("SafeJSON",function(){function t(){}return t.parse=function(t,n){try{return JSON.parse(t,n)}catch(t){return console.log(t),null}},t.stringify=function(t,n,r){try{return JSON.stringify(t,n,r)}catch(t){return""}},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/SceneDef.ts",["cc","./ModuleDef.ts"],(function(e){var n,t,c,u;return{setters:[function(e){n=e.cclegacy,t=e.assetManager,c=e.director},function(e){u=e.ModuleDef}],execute:function(){n._RF.push({},"402c86/nTlCBZjjfWHP0t76","SceneDef",void 0);var a=e("SceneDef",(function(){}));a.START={name:"start"},a.MAIN_MENU={name:"main_menu",bundle:u.BASIC},a.TANK_GAME={name:"tank_game",bundle:u.DEMO_TANK},a.ROOSTER_JUMP={name:"rooster_jump",bundle:u.DEMO_ROOSTER},e("SceneUtil",function(){function e(){}return e.loadScene=function(e,n){this.sceneParams=n,t.getBundle(e.bundle)?c.loadScene(e.name,(function(){tgx.UIMgr.inst.closeAll()})):t.loadBundle(e.bundle,(function(n,t){t&&c.loadScene(e.name,(function(){tgx.UIMgr.inst.closeAll()}))}))},e}()).sceneParams=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/SceneUtils.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,r,u,c;return{setters:[function(n){e=n.asyncToGenerator,t=n.regeneratorRuntime},function(n){r=n.cclegacy,u=n.director,c=n.assetManager}],execute:function(){r._RF.push({},"a97b9Z9/ixN3o1FLVqGpfE9","SceneUtils",void 0);n("ISceneInfo",(function(){this.name=void 0,this.bundle=void 0})),n("SceneUtil",function(){function n(){}return n.reloadScene=function(){var n=e(t().mark((function n(){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,e){u.loadScene(u.getScene().name,(function(){n(!0)}))})));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),n.loadScene=function(){var n=e(t().mark((function n(e){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,t){c.getBundle(e.bundle)?u.loadScene(e.name,(function(){n(!0)})):c.loadBundle(e.bundle,(function(t,r){r&&u.loadScene(e.name,(function(){n(!0)}))}))})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),n}());r._RF.pop()}}}));

System.register("chunks:///_virtual/Start.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameUILayers.ts","./ModuleDef.ts","./SceneDef.ts"],(function(e){var t,n,a,r,o,i,l,u,d,s,p,c,f,g,h,b,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,l=e.Label,u=e.Prefab,d=e.Node,s=e.game,p=e.assetManager,c=e.director,f=e.Component},function(e){g=e.GameUILayers,h=e.GameUILayerNames},function(e){b=e.ModuleDef},function(e){m=e.SceneDef}],execute:function(){var L,y,v,_,C,S,B,I,x;o._RF.push({},"66e163GxmdDp7kaguqDvTVl","Start",void 0);var M=i.ccclass,D=i.property,R=b.BASIC,P=m.MAIN_MENU,U=[b.BASIC],A=[],w=[{bundle:b.BASIC,url:"ui_alert/UI_Alert",type:"prefab"},{bundle:b.BASIC,url:"ui_waiting/UI_Waiting",type:"prefab"}];-1==A.indexOf(P)&&A.push(P);for(var z=0;z<A.length;++z){var N=A[z];-1==U.indexOf(N.bundle)&&U.push(N.bundle),w.push({bundle:N.bundle,url:N.name,type:"scene"})}var G=["Loading.","Loading..","Loading..."],T=U.length+w.length;e("Start",(L=M("Start"),y=D(l),v=D(u),_=D(d),L((B=t((S=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,a(t,"txtLoading",B,r(t)),a(t,"uiCanvasPrefab",I,r(t)),a(t,"loadingBar",x,r(t)),t._percent="",t._numCurrentLoaded=0,t}n(t,e);var o=t.prototype;return o.start=function(){tgx.ModuleContext.setDefaultModule(R),s.frameRate=61,tgx.UIMgr.inst.setup(this.uiCanvasPrefab,g.NUM,h),this.preloadBundle(0)},o.onResLoaded=function(){this._numCurrentLoaded++,this._percent=~~(this._numCurrentLoaded/T*100)+"%"},o.preloadBundle=function(e){var t=this;p.loadBundle(U[e],null,(function(n,a){console.log("module:<"+U[e]+">loaded."),e++,t.onResLoaded(),e<U.length?t.preloadBundle(e):t.preloadRes(0)}))},o.preloadRes=function(e){var t=this,n=w[e],a=p.getBundle(n.bundle),r=function(){e++,t.onResLoaded(),e<w.length?t.preloadRes(e):t.onPreloadingComplete()};a&&("prefab"==n.type?a.preload(n.url,u,r):"scene"==n.type&&a.preloadScene(n.url,r))},o.onPreloadingComplete=function(){c.loadScene(P.name)},o.update=function(e){if(this._percent)this.txtLoading.string="Loading..."+this._percent;else{var t=Math.floor(s.totalTime/1e3)%3;this.txtLoading.string=G[t]}this.loadingBar.setScale(this._numCurrentLoaded/T,1,1)},t}(f)).prototype,"txtLoading",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(S.prototype,"uiCanvasPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=t(S.prototype,"loadingBar",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=S))||C));o._RF.pop()}}}));

System.register("chunks:///_virtual/Story.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StoryDef.ts"],(function(t){var e,n,i;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy},function(t){i=t.StoryEffectType}],execute:function(){n._RF.push({},"7eba8L0W8RNAKKmbnzwWiUX","Story",void 0);t("Story",function(){function t(t){this._data=void 0,this._scenes=new Map,this._currentScene=null,this._data=t,this._initScenes()}var n=t.prototype;return n._initScenes=function(){var t=this;this._data.scenes.forEach((function(e){var n=new s(e);t._scenes.set(e.scene_id,n)}))},n.getStartScene=function(){return this._scenes.values().next().value},n.getSceneById=function(t){return this._scenes.get(t)},n.setCurrentScene=function(t){this._currentScene=this._scenes.get(t)},e(t,[{key:"storyId",get:function(){return this._data.story_id}},{key:"storyTitle",get:function(){return this._data.story_title}},{key:"description",get:function(){return this._data.description}}]),t}());var s=t("StoryScene",function(){function t(t){this._data=void 0,this._nodes=new Map,this._data=t,this._initNodes()}var n=t.prototype;return n._initNodes=function(){var t=this;this._data.nodes.forEach((function(e){var n=new c(e);t._nodes.set(e.node_id,n)}))},n.getStartNode=function(){return this._nodes.values().next().value},n.getNodeById=function(t){return this._nodes.get(t)},n.getNextNode=function(t){var e=this._nodes.get(t);return e?this._nodes.get(e.nextNodeId):null},e(t,[{key:"sceneId",get:function(){return this._data.scene_id}},{key:"sceneTitle",get:function(){return this._data.scene_title}}]),t}()),c=t("StoryNode",function(){function t(t){this._data=void 0,this._effects=[],this._data=t,this._initEffects()}var n=t.prototype;return n._initEffects=function(){this._data.effects&&(this._effects=this._data.effects.map((function(t){return new o(t)})))},n.processEffects=function(){this._effects.forEach((function(t){return t.execute()}))},e(t,[{key:"nodeId",get:function(){return this._data.node_id}},{key:"nodeType",get:function(){return this._data.node_type}},{key:"content",get:function(){return this._data.content||[]}},{key:"characterId",get:function(){return this._data.character_id}},{key:"prompt",get:function(){return this._data.prompt}},{key:"feedbackMessageToPlayer",get:function(){return this._data.feedback_message_to_player}},{key:"choices",get:function(){var t;return(null==(t=this._data.choices)?void 0:t.map((function(t){return new r(t)})))||[]}},{key:"nextNodeId",get:function(){return this._data.next_node_id}},{key:"effects",get:function(){return this._effects}}]),t}()),r=t("StoryChoice",function(){function t(t){this._data=void 0,this._effects=[],this._data=t,this._initEffects()}var n=t.prototype;return n._initEffects=function(){this._data.effects&&(this._effects=this._data.effects.map((function(t){return new o(t)})))},n.execute=function(){this._effects.forEach((function(t){return t.execute()}))},e(t,[{key:"choiceId",get:function(){return this._data.choice_id}},{key:"text",get:function(){return this._data.text}},{key:"nextNodeId",get:function(){return this._data.next_node_id}},{key:"effects",get:function(){return this._effects}}]),t}()),o=t("StoryEffect",function(){function t(t){this._data=void 0,this._data=t}var n=t.prototype;return n.execute=function(){switch(this._data.type){case i.LINK_VALUE_CHANGE:this._excuteChnageLinkValue()}},n._excuteChnageLinkValue=function(){},e(t,[{key:"type",get:function(){return this._data.type}},{key:"value",get:function(){return this._data.value}},{key:"target",get:function(){return this._data.target}}]),t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/StoryDef.ts",["cc"],(function(E){var S;return{setters:[function(E){S=E.cclegacy}],execute:function(){S._RF.push({},"8f095OaSAlEAYb5x80Hvub5","StoryDef",void 0);E("StoryNodeType",function(E){return E.SYSTEM_MESSAGE="SYSTEM_MESSAGE",E.HOST_DIALOGUE="HOST_DIALOGUE",E.PLAYER_CHOICE="PLAYER_CHOICE",E.SYSTEM_PLAYER_DIALOGUE="SYSTEM_PLAYER_DIALOGUE",E.SYSTEM_ACTION="SYSTEM_ACTION",E.STORY_END_FLAG="STORY_END_FLAG",E}({})),E("StoryEffectType",function(E){return E.LINK_VALUE_CHANGE="LINK_VALUE_CHANGE",E}({}));S._RF.pop()}}}));

System.register("chunks:///_virtual/StoryManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StoryDef.ts","./EventDef.ts","./Story.ts"],(function(t){var e,r,n,o,s,i,c,u,a,l,d,h;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,s=t.createClass},function(t){i=t.cclegacy,c=t._decorator,u=t.JsonAsset,a=t.Component},function(t){l=t.StoryNodeType},function(t){d=t.EventDef},function(t){h=t.Story}],execute:function(){var y,f,S,_,p,N;i._RF.push({},"11b37kmIilBdaMAqhxaFH7n","StoryManager",void 0);var g=c.ccclass,v=c.property;t("StoryManager",(y=g("StoryManager"),f=v(u),y(((N=function(t){function e(){for(var e,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return e=t.call.apply(t,[this].concat(s))||this,n(e,"storyAsset",p,o(e)),e._currentStory=null,e._currentScene=null,e._currentNode=null,e}r(e,t);var i=e.prototype;return i.onLoad=function(){null===e._instance&&(e._instance=this),this.loadStory()},i.loadStory=function(){this.storyAsset&&(this._currentStory=new h(this.storyAsset.json),this.startStory())},i.startStory=function(){if(this._currentStory&&(this._currentScene=this._currentStory.getStartScene(),this._currentScene)){var t=this._currentScene.getStartNode();t&&this.processNode(t)}},i.processNode=function(t){this._currentNode=t,tgx.EventMgr.inst.emit(d.NODE_PROCESS,t)},i.processNextNode=function(){if(this._currentNode){var t=this._currentScene.getNextNode(this._currentNode.nodeId);t&&this.processNode(t)}},i.makeChoice=function(t){if(this._currentNode&&this._currentNode.nodeType===l.PLAYER_CHOICE){var e=this._currentNode.choices.find((function(e){return e.choiceId===t}));if(e){e.execute();var r=this._currentScene.getNodeById(e.nextNodeId);r&&this.processNode(r)}}},s(e,null,[{key:"instance",get:function(){return e._instance}}]),e}(a))._instance=null,p=e((_=N).prototype,"storyAsset",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=_))||S));i._RF.pop()}}}));

System.register("chunks:///_virtual/tgx.ts",["cc","./SceneUtils.ts","./AudioMgr.ts","./InputMgr.ts","./ResourceMgr.ts","./SafeJSON.ts","./ResolutionAutoFit.ts","./ModuleContext.ts","./FPSCamera.ts","./FollowCamera2D.ts","./FreeCamera.ts","./ThirdPersonCamera.ts","./CharacterMovement.ts","./CharacterMovement2D.ts","./EasyController.ts","./ThirdPersonCameraCtrl.ts","./UIJoystick.ts","./UIAlert.ts","./Layout_UIWaiting.ts","./UIWaiting.ts","./EventDispatcher.ts","./EventMgr.ts","./UIController.ts","./UILayers.ts","./UIMgr.ts","./URLUtils.ts"],(function(){var t,e,n,r,o,a,i,s,u,c,l,f,C,U,I,g,m,M,y,h,v,S,d,F,E,L,R,A,p,D;return{setters:[function(e){t=e.cclegacy},function(t){e=t.ISceneInfo,n=t.SceneUtil},function(t){r=t.AudioMgr},function(t){o=t.InputMgr},function(t){a=t.ResourceMgr},function(t){i=t.SafeJSON},function(t){s=t.ResolutionAutoFit},function(t){u=t.ModuleContext},function(t){c=t.FPSCamera},function(t){l=t.FollowCamera2D},function(t){f=t.FreeCamera},function(t){C=t.ThirdPersonCamera},function(t){U=t.CharacterMovement},function(t){I=t.CharacterMovement2D},function(t){g=t.EasyController,m=t.EasyControllerEvent},function(t){M=t.ThirdPersonCameraCtrl},function(t){y=t.UIJoystick},function(t){h=t.Layout_UIAlert,v=t.UIAlert},function(t){S=t.Layout_UIWaiting},function(t){d=t.UIWaiting},function(t){F=t.EventDispatcher},function(t){E=t.EventMgr},function(t){L=t.UIController},function(t){R=t.UILayers,A=t.UILayerNames},function(t){p=t.UIMgr},function(t){D=t.URLUtils}],execute:function(){var P,_;t._RF.push({},"f6affkIabhNnqd5KRuhkVzy","tgx",void 0),(_=P||(P={})).ISceneInfo=e,_.SceneUtil=n,_.AudioMgr=r,_.InputMgr=o,_.ResourceMgr=a,_.SafeJSON=i,_.ResolutionAutoFit=s,_.ModuleContext=u,_.FPSCamera=c,_.FollowCamera2D=l,_.FreeCamera=f,_.ThirdPersonCamera=C,_.CharacterMovement=U,_.CharacterMovement2D=I,_.EasyController=g,_.EasyControllerEvent=m,_.ThirdPersonCameraCtrl=M,_.UIJoystick=y,_.Layout_UIAlert=h,_.UIAlert=v,_.Layout_UIWaiting=S,_.UIWaiting=d,_.EventDispatcher=F,_.EventMgr=E,_.UIController=L,_.UILayers=R,_.UILayerNames=A,_.UIMgr=p,_.URLUtils=D,globalThis.tgx=P,t._RF.pop()}}}));

System.register("chunks:///_virtual/ThirdPersonCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,r,a,o,l,s,u,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.v3,s=e.Node,u=e.Vec3,h=e.Component}],execute:function(){var c,g,p,f,b,m,y,d,_,M,w,v;a._RF.push({},"0e5acyZ1V5MwY4MXWYmJeO2","ThirdPersonCamera",void 0);var z=o.ccclass,A=o.property,L=l(),T=l();e("ThirdPersonCamera",(c=z("tgxThirdPersonCamera"),g=A(s),c((b=t((f=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,n(t,"target",b,r(t)),n(t,"lookAtOffset",m,r(t)),n(t,"zoomSensitivity",y,r(t)),n(t,"lenMin",d,r(t)),n(t,"lenMax",_,r(t)),n(t,"len",M,r(t)),n(t,"rotateVHSeparately",w,r(t)),n(t,"tweenTime",v,r(t)),t._targetLen=0,t._targetAngles=l(),t}i(t,e);var a=t.prototype;return a.start=function(){this._targetLen=this.len,this._targetAngles.set(this.node.eulerAngles)},a.setLenFactor=function(e){var t=(this.lenMax-this.lenMin)*e+this.lenMin;this._targetLen=t},a.setTargetAngles=function(e,t,i){this._targetAngles.set(e,t,i)},a.lateUpdate=function(e){if(this.target){var t=Math.min(e/this.tweenTime,1);L.set(this.node.eulerAngles),u.lerp(L,L,this._targetAngles,t),this.node.setRotationFromEuler(L),L.set(this.target.worldPosition),L.add(this.lookAtOffset),this.len=this.len*(1-t)+this._targetLen*t,T.set(this.node.forward),T.multiplyScalar(this.len),L.subtract(T),this.node.setPosition(L)}},a.onCameraRotate=function(e,t){var i=this.node.eulerAngles;this.rotateVHSeparately&&(Math.abs(e)>Math.abs(t)?t=0:e=0),this._targetAngles.set(i.x+20*e,i.y+20*t,i.z)},a.onCameraZoom=function(e){this._targetLen+=e*this.zoomSensitivity,this._targetLen<this.lenMin&&(this._targetLen=this.lenMin),this._targetLen>this.lenMax&&(this._targetLen=this.lenMax)},t}(h)).prototype,"target",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=t(f.prototype,"lookAtOffset",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return l()}}),y=t(f.prototype,"zoomSensitivity",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),d=t(f.prototype,"lenMin",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),_=t(f.prototype,"lenMax",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),M=t(f.prototype,"len",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),w=t(f.prototype,"rotateVHSeparately",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=t(f.prototype,"tweenTime",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),p=f))||p));a._RF.pop()}}}));

System.register("chunks:///_virtual/ThirdPersonCameraCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ThirdPersonCamera.ts","./EasyController.ts"],(function(t){var r,e,o,n,s,a;return{setters:[function(t){r=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator},function(t){n=t.ThirdPersonCamera},function(t){s=t.EasyController,a=t.EasyControllerEvent}],execute:function(){var i;e._RF.push({},"6ea3cEV3klIAZnz+Ay66ut+","ThirdPersonCameraCtrl",void 0);var l=o.ccclass;o.property,t("ThirdPersonCameraCtrl",l("tgxThirdPersonCameraCtrl")(i=function(t){function e(){return t.apply(this,arguments)||this}r(e,t);var o=e.prototype;return o.start=function(){s.on(a.CAMERA_ROTATE,this.onCameraRotate,this),s.on(a.CAMERA_ZOOM,this.onCameraZoom,this),this._targetLen=this.len,this._targetAngles.set(this.node.eulerAngles)},o.onDestroy=function(){s.off(a.CAMERA_ROTATE,this.onCameraRotate,this),s.off(a.CAMERA_ZOOM,this.onCameraZoom,this)},e}(n))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/UI_ChatItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ListItem.ts","./UIDef2.ts","./UI_SystemMesage.ts","./UI_HostDialogue.ts","./UI_PlayerChoice.ts","./UI_PlayerDialogue.ts","./UI_SystemAcrion.ts"],(function(t){var e,i,o,n,s,p,h,a,r,c,y,l,g,d,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,p=t._decorator,h=t.Node,a=t.UITransform},function(t){r=t.default},function(t){c=t.UIChatType},function(t){y=t.UI_SystemMesage},function(t){l=t.UI_HostDialogue},function(t){g=t.UI_PlayerChoice},function(t){d=t.UI_PlayerDialogue},function(t){u=t.UI_SystemAction}],execute:function(){var I,f,m,_,C;s._RF.push({},"e928eRCqAtEeILxdvIp/t9t","UI_ChatItem",void 0);var v=p.ccclass,N=p.property;t("UI_ChatItem",(I=v("UI_ChatItem"),f=N([h]),I((C=e((_=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),p=0;p<i;p++)s[p]=arguments[p];return e=t.call.apply(t,[this].concat(s))||this,o(e,"typeNodes",C,n(e)),e}return i(e,t),e.prototype.init=function(t){for(var e=0;e<this.typeNodes.length;e++)this.typeNodes[e].active=!1;if(t.type==c.SYSTEM_MESSAGE){this.typeNodes[0].active=!0;var i=this.typeNodes[0].getComponent(y).init(t.content);this.node.getComponent(a).height=i}else if(t.type==c.HOST_DIALOGUE){this.typeNodes[1].active=!0;var o=this.typeNodes[1].getComponent(l).init(t.content);this.node.getComponent(a).height=o}else if(t.type==c.PLAYER_CHOICE)if(2==t.choices.length){this.typeNodes[2].active=!0;var n=this.typeNodes[2].getComponent(g).init(t);this.node.getComponent(a).height=n}else{this.typeNodes[3].active=!0;var s=this.typeNodes[3].getComponent(g).init(t);this.node.getComponent(a).height=s}else if(t.type==c.SYSTEM_PLAYER_DIALOGUE){this.typeNodes[4].active=!0;var p=this.typeNodes[4].getComponent(d).init(t.content);this.node.getComponent(a).height=p}else if(t.type==c.SYSTEM_ACTION){this.typeNodes[5].active=!0;var h=this.typeNodes[5].getComponent(u).init(t.content);this.node.getComponent(a).height=h}else t.type==c.STORY_END_FLAG&&(this.typeNodes[6].active=!0,this.node.getComponent(a).height=this.typeNodes[6].getComponent(a).height)},e}(r)).prototype,"typeNodes",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),m=_))||m));s._RF.pop()}}}));

System.register("chunks:///_virtual/UI_EndFlag.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,r,c;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,r=n._decorator,c=n.Component}],execute:function(){var o;e._RF.push({},"6fdc59g7llLH5QB1x2z4dxj","UI_EndFlag",void 0);var l=r.ccclass;r.property,n("UI_EndFlag",l("UI_EndFlag")(o=function(n){function e(){return n.apply(this,arguments)||this}return t(e,n),e}(c))||o);e._RF.pop()}}}));

System.register("chunks:///_virtual/UI_Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./StoryDef.ts","./List.ts","./EventDef.ts","./UI_ChatItem.ts","./UIDef2.ts","./StoryManager.ts"],(function(t){var e,n,s,o,c,i,a,r,h,l,f,u,p,E,S;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,s=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){c=t.cclegacy,i=t._decorator,a=t.game,r=t.log,h=t.Component},function(t){l=t.StoryNodeType},function(t){f=t.default},function(t){u=t.EventDef},function(t){p=t.UI_ChatItem},function(t){E=t.UIChatType},function(t){S=t.StoryManager}],execute:function(){var d,g,C,_,y;c._RF.push({},"53f47l1SZtI6J0GRAEcl/Z/","UI_Game",void 0);var I=i.ccclass,m=i.property;t("UI_Game",(d=I("UI_Game"),g=m(f),d((y=e((_=function(t){function e(){for(var e,n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return e=t.call.apply(t,[this].concat(c))||this,s(e,"list",y,o(e)),e._chatList=[],e}n(e,t);var c=e.prototype;return c.onLoad=function(){a.frameRate=120,tgx.EventMgr.inst.on(u.NODE_PROCESS,this.onNodeProcess,this),tgx.EventMgr.inst.on(u.EFFECT_PROCESS,this.onEffectProcess,this),tgx.EventMgr.inst.on(u.CHOICE_PROCESS,this.onChoiceProcess,this)},c.onDestroy=function(){tgx.EventMgr.inst.off(u.NODE_PROCESS,this.onNodeProcess,this),tgx.EventMgr.inst.off(u.EFFECT_PROCESS,this.onEffectProcess,this),tgx.EventMgr.inst.off(u.CHOICE_PROCESS,this.onChoiceProcess,this)},c.onNodeProcess=function(t){switch(t.nodeType){case l.SYSTEM_MESSAGE:this.processSystemMessage(t);break;case l.HOST_DIALOGUE:this.processHostDialogue(t);break;case l.SYSTEM_PLAYER_DIALOGUE:this.processSystemPlayerDialogue(t);break;case l.PLAYER_CHOICE:this.processPlayerChoice(t);break;case l.SYSTEM_ACTION:this.processSystemAction(t);break;case l.STORY_END_FLAG:this.processStoryEndFlag(t)}},c.processSystemMessage=function(t){var e=this;if(t.content.length>0){var n=0;this.addChatItem({type:E.SYSTEM_MESSAGE,content:t.content[n]}),this.schedule((function(){r("processSystemMessage",n),++n!=t.content.length?e.addChatItem({type:E.SYSTEM_MESSAGE,content:t.content[n]}):S.instance.processNextNode()}),1,t.content.length-1)}else S.instance.processNextNode()},c.processHostDialogue=function(t){var e=this;if(t.content.length>0){var n=0;this.addChatItem({type:E.HOST_DIALOGUE,content:t.content[n]}),this.schedule((function(){++n!=t.content.length?e.addChatItem({type:E.HOST_DIALOGUE,content:t.content[n]}):S.instance.processNextNode()}),1,t.content.length-1)}else S.instance.processNextNode()},c.processPlayerChoice=function(t){this.addChatItem({type:E.PLAYER_CHOICE,prompt:t.prompt,choices:t.choices.map((function(t){return{choiceId:t.choiceId,choiceText:t.text}}))})},c.processSystemPlayerDialogue=function(t){this.addChatItem({type:E.SYSTEM_PLAYER_DIALOGUE,content:t.content[0]}),this.scheduleOnce((function(){S.instance.processNextNode()}),1)},c.processSystemAction=function(t){this.addChatItem({type:E.SYSTEM_ACTION,content:t.feedbackMessageToPlayer||"..."}),this.scheduleOnce((function(){S.instance.processNextNode()}),1)},c.processStoryEndFlag=function(t){this.addChatItem({type:E.STORY_END_FLAG,content:t.content[0]})},c.addChatItem=function(t){this._chatList.push(t),this.list.numItems=this._chatList.length,this.list.scrollTo(this._chatList.length-1),r("addChatItem",this._chatList.length)},c.onEffectProcess=function(t){},c.onChoiceProcess=function(t){r("onChoiceProcess",t),S.instance.makeChoice(t)},c.onListRender=function(t,e){t.active=!0,t.getComponent(p).init(this._chatList[e])},e}(h)).prototype,"list",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=_))||C));c._RF.pop()}}}));

System.register("chunks:///_virtual/UI_HostDialogue.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,i,o,a,s,l,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,s=t.Label,l=t.UITransform,u=t.Component}],execute:function(){var c,p,h,g,d;o._RF.push({},"1ddb49NJllLDbbP6Q5hKdv5","UI_HostDialogue",void 0);var f=a.ccclass,y=a.property;t("UI_HostDialogue",(c=f("UI_HostDialogue"),p=y(s),c((d=e((g=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,r(e,"text",d,i(e)),e}return n(e,t),e.prototype.init=function(t){this.text.string=t,this.text.updateRenderData();var e=this.text.node.getComponent(l).height;return this.node.getComponent(l).height=e+5,e+5},e}(u)).prototype,"text",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=g))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/UI_PlayerChoice.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventDef.ts"],(function(e){var t,i,o,n,c,r,s,h,l,a,p,u,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){c=e.cclegacy,r=e._decorator,s=e.Label,h=e.Node,l=e.Button,a=e.UITransform,p=e.log,u=e.Component},function(e){d=e.EventDef}],execute:function(){var f,g,C,v,m,y,b;c._RF.push({},"9ed16hdyJtLpqO4p0xzNRUl","UI_PlayerChoice",void 0);var N=r.ccclass,I=r.property;e("UI_PlayerChoice",(f=N("UI_PlayerChoice"),g=I(s),C=I(h),f((y=t((m=function(e){function t(){for(var t,i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return t=e.call.apply(e,[this].concat(c))||this,o(t,"prompt",y,n(t)),o(t,"choiceNodes",b,n(t)),t}i(t,e);var c=t.prototype;return c.init=function(e){this.prompt.string=e.prompt;for(var t=0;t<this.choiceNodes.length;t++)t<e.choices.length?(this.choiceNodes[t].active=!0,this.choiceNodes[t].getComponentInChildren(s).string=e.choices[t].choiceText,this.choiceNodes[t].getComponent(l).clickEvents[0].customEventData=e.choices[t].choiceId):this.choiceNodes[t].active=!1;return this.node.getComponent(a).height},c.onChoiceClick=function(e,t){p("onChoiceClick",t),tgx.EventMgr.inst.emit(d.CHOICE_PROCESS,t),this.disableAllChoice()},c.disableAllChoice=function(){for(var e=0;e<this.choiceNodes.length;e++)this.choiceNodes[e].getComponent(l).interactable=!1},t}(u)).prototype,"prompt",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(m.prototype,"choiceNodes",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=m))||v));c._RF.pop()}}}));

System.register("chunks:///_virtual/UI_PlayerDialogue.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,n,i,o,a,l,u,s;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Label,u=e.UITransform,s=e.Component}],execute:function(){var c,p,h,g,y;o._RF.push({},"bd4aaU0mTdKk5dze6eDHIs0","UI_PlayerDialogue",void 0);var d=a.ccclass,f=a.property;e("UI_PlayerDialogue",(c=d("UI_PlayerDialogue"),p=f(l),c((y=t((g=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"text",y,i(t)),t}return r(t,e),t.prototype.init=function(e){this.text.string=e,this.text.updateRenderData();var t=this.text.node.getComponent(u).height;return this.node.getComponent(u).height=t+5,t+5},t}(s)).prototype,"text",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=g))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/UI_SystemAcrion.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,i,o,c,s,a,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,c=t._decorator,s=t.Label,a=t.UITransform,p=t.Component}],execute:function(){var u,l,h,y,f;o._RF.push({},"7d100udMc9CppqQgn5yGjVp","UI_SystemAcrion",void 0);var d=c.ccclass,g=c.property;t("UI_SystemAction",(u=d("UI_SystemAction"),l=g(s),u((f=e((y=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o))||this,r(e,"text",f,i(e)),e}return n(e,t),e.prototype.init=function(t){this.text.string=t,this.text.updateRenderData();var e=this.text.node.getComponent(a).height;return this.node.getComponent(a).height=e+5,e+5},e}(p)).prototype,"text",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=y))||h));o._RF.pop()}}}));

System.register("chunks:///_virtual/UI_SystemMesage.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,i,o,s,a,c,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,a=e.Label,c=e.UITransform,l=e.Component}],execute:function(){var u,p,g,h,y;o._RF.push({},"bb76dqnAglCBbYKz8b/7gze","UI_SystemMesage",void 0);var f=s.ccclass,d=s.property;e("UI_SystemMesage",(u=f("UI_SystemMesage"),p=d(a),u((y=t((h=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,r(t,"text",y,i(t)),t}return n(t,e),t.prototype.init=function(e){this.text.string=e,this.text.updateRenderData();var t=this.text.node.getComponent(c).height;return this.node.getComponent(c).height=t+5,t+5},t}(l)).prototype,"text",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=h))||g));o._RF.pop()}}}));

System.register("chunks:///_virtual/UIAlert.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIController.ts","./UIMgr.ts"],(function(t){var n,i,e,o,r,l,c,a,s,u,h,p;return{setters:[function(t){n=t.applyDecoratedDescriptor,i=t.inheritsLoose,e=t.createClass,o=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){l=t.cclegacy,c=t._decorator,a=t.Label,s=t.Button,u=t.Component},function(t){h=t.UIController},function(t){p=t.UIMgr}],execute:function(){var b,_,f,v,y,C,g,d,w,k,A;l._RF.push({},"7e91f8G1GtMQ4+Lvts9iEeD","UIAlert",void 0);var I=c.ccclass,U=c.property,z=(t("Layout_UIAlert",(b=I("tgxLayout_UIAlert"),_=U(a),f=U(a),v=U(s),y=U(s),b((d=n((g=function(t){function n(){for(var n,i=arguments.length,e=new Array(i),l=0;l<i;l++)e[l]=arguments[l];return n=t.call.apply(t,[this].concat(e))||this,o(n,"title",d,r(n)),o(n,"content",w,r(n)),o(n,"btnOK",k,r(n)),o(n,"btnCancel",A,r(n)),n}return i(n,t),n}(u)).prototype,"title",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=n(g.prototype,"content",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=n(g.prototype,"btnOK",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=n(g.prototype,"btnCancel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=g))||C)),t("UIAlertOptions",function(){function t(){this._title=void 0,this._content=void 0,this._showCancel=void 0,this._cbClick=void 0,this._cbClickThisArg=void 0}var n=t.prototype;return n.setTitle=function(t){return this._title=t,this},n.onClick=function(t,n){return this._cbClick=t,this._cbClickThisArg=n,this},t}()));t("UIAlert",function(t){function n(){for(var n,i=arguments.length,e=new Array(i),o=0;o<i;o++)e[o]=arguments[o];return(n=t.call.apply(t,[this].concat(e))||this)._options=void 0,n}i(n,t),n.show=function(t,i){var e=new z;return e._content=t,e._showCancel=i,p.inst.showUI(n,(function(t){t.init(e)})),e};var o=n.prototype;return o.init=function(t){this._options=t;var n=this._options,i=this.layout;if(n.hasOwnProperty("title")&&(i.title.string=n._title||""),i.content.string=n._content||"",i.btnCancel.node.active=n._showCancel,!n._showCancel){var e=i.btnOK.node.position;i.btnOK.node.setPosition(0,e.y,e.z)}},o.onCreated=function(){var t=this,n=this.layout;this.onButtonEvent(n.btnOK,(function(){t.close();var n=t._options;n._cbClick&&n._cbClick.call(n._cbClickThisArg,!0)})),this.onButtonEvent(n.btnCancel,(function(){t.close();var n=t._options;n._cbClick&&n._cbClick.call(n._cbClickThisArg,!1)}))},e(n,[{key:"layout",get:function(){return t.prototype.layout}}]),n}(h));l._RF.pop()}}}));

System.register("chunks:///_virtual/UIController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DoubleList.ts"],(function(t){var n,e,o,i,s,r,a,l,c,d,u,v,f,h;return{setters:[function(t){n=t.inheritsLoose,e=t.createClass},function(t){o=t.cclegacy,i=t._decorator,s=t.Button,r=t.Node,a=t.find,l=t.EventHandler,c=t.Toggle,d=t.ToggleContainer,u=t.Slider,v=t.Component,f=t.isValid},function(t){h=t.DoubleList}],execute:function(){var g;o._RF.push({},"de702l/FU1GyIzhfLW2eNqP","UIController",void 0);var p=i.ccclass,$=(i.property,t("__NodeEventAgent__",p("tgxNodeEventAgent")(g=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.onButtonClicked=function(t,n){for(var e=t.target.getComponent(s),o=e.clickEvents,i=0;i<o.length;++i){var r=o[i];if(r.customEventData==n){var a=r.$cb$,l=r.$target$,c=r.$args$;a.apply(l,[e,c])}}},o.onToggleEvent=function(t,n){var e=t.checkEvents;t._toggleContainer&&(e=t._toggleContainer.checkEvents);for(var o=0;o<e.length;++o){var i=e[o];if(i.customEventData==n){var s=i.$cb$,r=i.$target$,a=i.$args$;s.apply(r,[t,a])}}},o.onSlideEvent=function(t,n){for(var e=t.slideEvents,o=0;o<e.length;++o){var i=e[o];if(i.customEventData==n){var s=i.$cb$,r=i.$target$,a=i.$args$;s.apply(r,[t,a])}}},e}(v))||g)),_=t("UIController",function(){function t(n,e,o){this._listItem=null,this._instId=0,this._prefab=void 0,this._layer=void 0,this._layout=void 0,this.node=void 0,this._destroyed=!1,this._ingoreCloseAll=!1,this._prefab=n,this._layer=e,this._layout=o,this._instId=t._idBase++,this._listItem=t._controllers.addToTail(this)}t.closeAll=function(){this._controllers.forEach((function(t){var n=t.data;n._ingoreCloseAll||n.close()}))},t.updateAll=function(t){this._controllers.forEach((function(n){var e=n.data;e.node&&f(e.node)&&e.onUpdate(t)}))};var n=t.prototype;return n.setup=function(t,n){this.node=t,this._layout&&(this._layout=this.node.getComponent(this._layout)),this.onCreated(n),this._destroyed&&this.close()},n.close=function(){var t;this._destroyed=!0,null==(t=this._listItem)||t.dispose(),this._listItem=null,this.node&&(this.node.removeFromParent(),this.onDispose(),this.node.destroy(),this.node=null)},n.onButtonEvent=function(n,e,o,i){var c=null;if(!(c=n instanceof r?n:n instanceof s?n.node:a(n,this.node)))return null;var d=this.node.getComponent($);d||(d=this.node.addComponent($));var u=c.getComponent(s),v=u.clickEvents,f=new l;f.target=this.node,f.component="tgxNodeEventAgent",f.handler="onButtonClicked",f.customEventData=""+t._idBase++,f.$cb$=e,f.$target$=o,f.$args$=i,v.push(f),u.clickEvents=v},n.offButtonEvent=function(t,n,e){var o=null;if((o=t instanceof r?t:t instanceof s?t.node:a(t,this.node))&&this.node.getComponent($)){var i=o.getComponent(s);if(i)for(var l=i.clickEvents,c=0;c<l.length;++c){var d=l[c];if(d.$cb$==n&&d.$target$==e){l.splice(c,1),i.clickEvents=l;break}}}},n.onToggleEvent=function(n,e,o,i){var s=null;if(!(s=n instanceof r?n:n instanceof c||n instanceof d?n.node:a(n,this.node)))return null;var u=this.node.getComponent($);u||(u=this.node.addComponent($));var v=s.getComponent(c);v||(v=s.getComponent(d));var f=v.checkEvents,h=new l;h.target=this.node,h.component="tgxNodeEventAgent",h.handler="onToggleEvent",h.customEventData=""+t._idBase++,h.$cb$=e,h.$target$=o,h.$args$=i,f.push(h),v.checkEvents=f},n.offToggleEvent=function(t,n,e){var o=null;if(!(o=t instanceof r?t:t instanceof c||t instanceof d?t.node:a(t,this.node)))return null;if(this.node.getComponent($)){var i=o.getComponent(c);i||(i=o.getComponent(d));for(var s=i.checkEvents,l=0;l<s.length;++l){var u=s[l];if(u.$cb$==n&&u.$target$==e){s.splice(l,1),i.checkEvents=s;break}}}},n.onSlideEvent=function(n,e,o,i){var s=null;if(!(s=n instanceof r?n:n instanceof u?n.node:a(n,this.node)))return null;var c=this.node.getComponent($);c||(c=this.node.addComponent($));var d=s.getComponent(u),v=d.slideEvents,f=new l;f.target=this.node,f.component="tgxNodeEventAgent",f.handler="onSlideEvent",f.customEventData=""+t._idBase++,f.$cb$=e,f.$target$=o,f.$args$=i,v.push(f),d.slideEvents=v},n.offSlideEvent=function(t,n,e){var o=null;if(!(o=t instanceof r?t:t instanceof u?t.node:a(t,this.node)))return null;if(this.node.getComponent($))for(var i=o.getComponent(u),s=i.slideEvents,l=0;l<s.length;++l){var c=s[l];if(c.$cb$==n&&c.$target$==e){s.splice(l,1),i.slideEvents=s;break}}},n.getRes=function(){return[]},n.onCreated=function(t){},n.onDispose=function(){},n.onUpdate=function(t){},e(t,[{key:"instId",get:function(){return this._instId}},{key:"prefab",get:function(){return this._prefab}},{key:"layer",get:function(){return this._layer}},{key:"layout",get:function(){return this._layout}}]),t}());_._idBase=1e3,_._controllers=new h,o._RF.pop()}}}));

System.register("chunks:///_virtual/UIDef.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ModuleDef.ts"],(function(e){var t,n,o;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy},function(e){o=e.ModuleDef}],execute:function(){var u;n._RF.push({},"2d1b47HeBlMUoHY2m4BwD9Z","UIDef",void 0);e("UI_AboutMe",tgx_class(o.EXTRA)(u=function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n}(tgx.UIController))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/UIDef2.ts",["cc"],(function(E){var S;return{setters:[function(E){S=E.cclegacy}],execute:function(){S._RF.push({},"ef198L7judGvp0DcpmCRSeW","UIDef",void 0);E("UIChatType",function(E){return E.SYSTEM_MESSAGE="SYSTEM_MESSAGE",E.HOST_DIALOGUE="HOST_DIALOGUE",E.PLAYER_CHOICE="PLAYER_CHOICE",E.SYSTEM_PLAYER_DIALOGUE="SYSTEM_PLAYER_DIALOGUE",E.SYSTEM_ACTION="SYSTEM_ACTION",E.STORY_END_FLAG="STORY_END_FLAG",E}({}));S._RF.pop()}}}));

System.register("chunks:///_virtual/UIJoystick.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EasyController.ts"],(function(t){var e,i,o,n,s,h,_,a,r,c,u,l;return{setters:[function(t){e=t.inheritsLoose,i=t.createClass},function(t){o=t.cclegacy,n=t._decorator,s=t.KeyCode,h=t.UITransform,_=t.Input,a=t.input,r=t.director,c=t.isValid,u=t.Component},function(t){l=t.EasyControllerEvent}],execute:function(){var T,E;o._RF.push({},"0d3fdUMUH1Fq4G13IWj7Lf2","UIJoystick",void 0);var v=n.ccclass;n.property,t("UIJoystick",v("tgxUIJoystick")(((E=function(t){function o(){for(var e,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(e=t.call.apply(t,[this].concat(o))||this)._ctrlRoot=null,e._ctrlPointer=null,e._buttons=null,e._cameraSensitivity=.1,e._distanceOfTwoTouchPoint=0,e._movementTouch=null,e._cameraTouchA=null,e._cameraTouchB=null,e._fullscreen=null,e._scene=null,e._key2buttonMap={},e._keys=[],e._degree=0,e._key2dirMap=null,e}e(o,t);var n=o.prototype;return n.onLoad=function(){o._inst=this,this._key2buttonMap[s.KEY_J]="btn_slot_0",this._key2buttonMap[s.KEY_K]="btn_slot_1",this._key2buttonMap[s.KEY_L]="btn_slot_2",this._key2buttonMap[s.KEY_U]="btn_slot_3",this._key2buttonMap[s.KEY_I]="btn_slot_4";var t=this.node.getChildByName("checker_camera").getComponent(h);t.node.on(_.EventType.TOUCH_START,this.onTouchStart_CameraCtrl,this),t.node.on(_.EventType.TOUCH_MOVE,this.onTouchMove_CameraCtrl,this),t.node.on(_.EventType.TOUCH_END,this.onTouchUp_CameraCtrl,this),t.node.on(_.EventType.TOUCH_CANCEL,this.onTouchUp_CameraCtrl,this);var e=this.node.getChildByName("checker_movement").getComponent(h);e.node.on(_.EventType.TOUCH_START,this.onTouchStart_Movement,this),e.node.on(_.EventType.TOUCH_MOVE,this.onTouchMove_Movement,this),e.node.on(_.EventType.TOUCH_END,this.onTouchUp_Movement,this),e.node.on(_.EventType.TOUCH_CANCEL,this.onTouchUp_Movement,this),this._fullscreen=this.node.getComponent(h),this._ctrlRoot=this.node.getChildByName("ctrl").getComponent(h),this._ctrlRoot.node.active=!1,this._ctrlPointer=this._ctrlRoot.node.getChildByName("pointer"),this._buttons=this.node.getChildByName("buttons"),a.on(_.EventType.KEY_DOWN,this.onKeyDown,this),a.on(_.EventType.KEY_UP,this.onKeyUp,this),a.on(_.EventType.MOUSE_WHEEL,this.onMouseWheel,this),this._scene=r.getScene()},n.onDestroy=function(){a.off(_.EventType.KEY_DOWN,this.onKeyDown,this),a.off(_.EventType.KEY_UP,this.onKeyUp,this),a.off(_.EventType.MOUSE_WHEEL,this.onMouseWheel,this),this._scene=null,o._inst=null},n.cleanKeyMap=function(){this._key2buttonMap={}},n.bindKeyToButton=function(t,e){this._key2buttonMap[t]=e},n.setButtonVisible=function(t,e){var i,o=null==(i=this._buttons)?void 0:i.getChildByName(t);o&&(o.active=e)},n.getButtonByName=function(t){return this._buttons.getChildByName(t)},n.onTouchStart_Movement=function(t){for(var e=t.getTouches(),i=0;i<e.length;++i){var o=e[i],n=o.getUILocationX(),s=o.getUILocationY();if(!this._movementTouch){var h=this._fullscreen.width/2,_=this._fullscreen.height/2;this._ctrlRoot.node.active=!0,this._ctrlRoot.node.setPosition(n-h,s-_,0),this._ctrlPointer.setPosition(0,0,0),this._movementTouch=o}}},n.onTouchMove_Movement=function(t){for(var e=t.getTouches(),i=0;i<e.length;++i){var o=e[i];if(this._movementTouch&&o.getID()==this._movementTouch.getID()){var n=this._fullscreen.width/2,s=this._fullscreen.height/2,h=o.getUILocationX(),_=o.getUILocationY(),a=this._ctrlRoot.node.position,r=h-n-a.x,c=_-s-a.y,u=Math.sqrt(r*r+c*c);if(u<=0)return;var T=r/u,E=c/u,v=this._ctrlRoot.width/2;u>v&&(u=v,r=T*v,c=E*v),this._ctrlPointer.setPosition(r,c,0);var m=Math.atan(E/T)/Math.PI*180;m+=T<0?180:360,this.emitEvent(l.MOVEMENT,m,u/v)}}},n.onTouchUp_Movement=function(t){for(var e=t.getTouches(),i=0;i<e.length;++i){var o=e[i];this._movementTouch&&o.getID()==this._movementTouch.getID()&&(this.emitEvent(l.MOVEMENT_STOP),this._movementTouch=null,this._ctrlRoot.node.active=!1)}},n.getDistOfTwoTouchPoints=function(){var t=this._cameraTouchA,e=this._cameraTouchB;if(!t||!e)return 0;var i=t.getLocationX()-e.getLocationX(),o=e.getLocationY()-e.getLocationY();return Math.sqrt(i*i+o*o)},n.onTouchStart_CameraCtrl=function(t){this.emitEvent(l.SCREEN_TOUCH_START,t);var e=t.getAllTouches();this._cameraTouchA=null,this._cameraTouchB=null;for(var i=e.length-1;i>=0;i--){var o=e[i];if(!this._movementTouch||o.getID()!=this._movementTouch.getID())if(null==this._cameraTouchA)this._cameraTouchA=e[i];else if(null==this._cameraTouchB){this._cameraTouchB=e[i];break}}this._distanceOfTwoTouchPoint=this.getDistOfTwoTouchPoints()},n.onTouchMove_CameraCtrl=function(t){for(var e=t.getTouches(),i=0;i<e.length;++i){var o=e[i],n=o.getID();if(this._cameraTouchA&&this._cameraTouchB){console.log(n,this._cameraTouchA.getID(),this._cameraTouchB.getID());var s=!1;if(n==this._cameraTouchA.getID()&&(this._cameraTouchA=o,s=!0),n==this._cameraTouchB.getID()&&(this._cameraTouchB=o,s=!0),s){var h=this.getDistOfTwoTouchPoints(),_=this._distanceOfTwoTouchPoint-h;this.emitEvent(l.CAMERA_ZOOM,_),this._distanceOfTwoTouchPoint=h}}else if(this._cameraTouchA&&n==this._cameraTouchA.getID()){var a=o.getDelta(),r=a.y*this._cameraSensitivity,c=-a.x*this._cameraSensitivity;this.emitEvent(l.CAMERA_ROTATE,r,c)}}},n.onTouchUp_CameraCtrl=function(t){this.emitEvent(l.SCREEN_TOUCH_END,t);for(var e=t.getAllTouches(),i=!1,o=!1,n=0;n<e.length;++n){var s=e[n].getID();this._cameraTouchA&&s==this._cameraTouchA.getID()?i=!0:this._cameraTouchB&&s==this._cameraTouchB.getID()&&(o=!0)}i||(this._cameraTouchA=null),o||(this._cameraTouchB=null)},n.onKeyDown=function(t){var e=t.keyCode;if(e==s.KEY_A||e==s.KEY_S||e==s.KEY_D||e==s.KEY_W)-1==this._keys.indexOf(e)&&(this._keys.push(e),this.updateDirection());else{var i=this._key2buttonMap[e];i&&this.emitEvent(l.BUTTON,i)}},n.onKeyUp=function(t){var e=t.keyCode;if(e==s.KEY_A||e==s.KEY_S||e==s.KEY_D||e==s.KEY_W){var i=this._keys.indexOf(e);-1!=i&&(this._keys.splice(i,1),this.updateDirection())}},n.onMouseWheel=function(t){var e=.1*t.getScrollY();this.emitEvent(l.CAMERA_ZOOM,e)},n.onButtonSlot=function(t){var e=t.target.name;this.emitEvent(l.BUTTON,e)},n.updateDirection=function(){null==this._key2dirMap&&(this._key2dirMap={},this._key2dirMap[0]=-1,this._key2dirMap[s.KEY_A]=180,this._key2dirMap[s.KEY_D]=0,this._key2dirMap[s.KEY_W]=90,this._key2dirMap[s.KEY_S]=270,this._key2dirMap[1e3*s.KEY_A+s.KEY_W]=this._key2dirMap[1e3*s.KEY_W+s.KEY_A]=135,this._key2dirMap[1e3*s.KEY_D+s.KEY_W]=this._key2dirMap[1e3*s.KEY_W+s.KEY_D]=45,this._key2dirMap[1e3*s.KEY_A+s.KEY_S]=this._key2dirMap[1e3*s.KEY_S+s.KEY_A]=225,this._key2dirMap[1e3*s.KEY_D+s.KEY_S]=this._key2dirMap[1e3*s.KEY_S+s.KEY_D]=315,this._key2dirMap[1e3*s.KEY_A+s.KEY_D]=this._key2dirMap[s.KEY_D],this._key2dirMap[1e3*s.KEY_D+s.KEY_A]=this._key2dirMap[s.KEY_A],this._key2dirMap[1e3*s.KEY_W+s.KEY_S]=this._key2dirMap[s.KEY_S],this._key2dirMap[1e3*s.KEY_S+s.KEY_W]=this._key2dirMap[s.KEY_W]);var t=this._keys[this._keys.length-1]||0,e=this._keys[this._keys.length-2]||0;this._degree=this._key2dirMap[1e3*e+t],null==this._degree||this._degree<0?this.emitEvent(l.MOVEMENT_STOP):this.emitEvent(l.MOVEMENT,this._degree,1)},n.emitEvent=function(t,e,i,o,n,s){c(this._scene)?this._scene.emit(t,e,i,o,n,s):console.log("oops!")},i(o,null,[{key:"inst",get:function(){return this._inst}}]),o}(u))._inst=null,T=E))||T);o._RF.pop()}}}));

System.register("chunks:///_virtual/UILayers.ts",["cc"],(function(e){var P;return{setters:[function(e){P=e.cclegacy}],execute:function(){P._RF.push({},"c15e5F/JCxBY7zW+STv7O08","UILayers",void 0);var r=e("UILayers",function(e){return e[e.GAME=0]="GAME",e[e.JOY_STICK=1]="JOY_STICK",e[e.HUD=2]="HUD",e[e.POPUP=3]="POPUP",e[e.POPUP1=4]="POPUP1",e[e.POPUP2=5]="POPUP2",e[e.ALERT=6]="ALERT",e[e.NOTICE=7]="NOTICE",e[e.LOADING=8]="LOADING",e[e.OVERLAY=9]="OVERLAY",e[e.NUM=10]="NUM",e}(r||{}));e("UILayerNames",["game","joy_stick","hud","popup","popup1","popup2","alert","notice","loading","overlay"]);P._RF.pop()}}}));

System.register("chunks:///_virtual/UIMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIController.ts","./ModuleContext.ts","./ResolutionAutoFit.ts"],(function(t){var e,n,o,i,r,s,a,u,l,c,d,h,f,g,p;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){o=t.cclegacy,i=t._decorator,r=t.UITransform,s=t.Node,a=t.Widget,u=t.error,l=t.instantiate,c=t.director,d=t.assetManager,h=t.Component},function(t){f=t.UIController},function(t){g=t.ModuleContext},function(t){p=t.ResolutionAutoFit}],execute:function(){var v;o._RF.push({},"82a59QFSGVIYrBkrgAX1U2r","UIMgr",void 0);var C=i.ccclass,_=(i.property,C("tgxUIMgr.UIUpdater")(v=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n.prototype.update=function(t){f.updateAll(t)},n}(h))||v);t("UIMgr",function(){function t(){this._uiCanvas=void 0,this._uiRoot=void 0}var e=t.prototype;return e.createFullScreenNode=function(){var t=this._uiCanvas.getComponent(r),e=new s;e.layer=this._uiCanvas.layer;var n=e.addComponent(r);n.width=t.width,n.height=t.height;var o=e.addComponent(a);return o.isAlignBottom=!0,o.isAlignTop=!0,o.isAlignLeft=!0,o.isAlignRight=!0,o.left=0,o.right=0,o.top=0,o.bottom=0,e},e.setup=function(t,e,n){if(!this._uiCanvas){if(!t)throw u("uiCanvas must be a Node or Prefab");t instanceof s?this._uiCanvas=t:(this._uiCanvas=l(t),c.getScene().addChild(this._uiCanvas)),this._uiCanvas.name="$tgxUICanvas$",c.addPersistRootNode(this._uiCanvas),this._uiCanvas.getComponent(_)||this._uiCanvas.addComponent(_);var o=this._uiCanvas.getComponent(r);this._uiCanvas.addComponent(p),n||(n=[]),this._uiRoot=this.createFullScreenNode(),this._uiRoot.name="ui_root",o.node.addChild(this._uiRoot);for(var i=0;i<e;++i){var a=this.createFullScreenNode();a.name="ui_layer_"+(n[i]?n[i]:i),this._uiRoot.addChild(a)}}},e.getLayerNode=function(t){return this._uiRoot.children[t]||this._uiRoot},e.closeAll=function(){f.closeAll()},e.getUI=function(t){for(var e=f._controllers,n=0;n<e.length;++n){var o=e[n];if(o instanceof t)return o}return null},e.isShowing=function(t){for(var e=f._controllers,n=0;n<e.length;++n)if(e[n]instanceof t)return!0;return!1},e.showUI=function(e,n,o,i){var r=this,s=g.getClassModule(e);if(s&&!d.getBundle(s))return void d.loadBundle(s,null,(function(t,s){t?console.log(t):r.showUI(e,n,o,i)}));var a=g.createFromModule(e),u=a.getRes()||[];"string"==typeof a.prefab&&u.push(a.prefab);return s=s||"resources",function(e){return e.load(u,(function(s,u){s&&console.log(s);var c=null,d=a.prefab;"string"==typeof a.prefab&&(d=e.get(a.prefab)),c=d?l(d):r.createFullScreenNode(),t.inst.getLayerNode(a.layer).addChild(c),a.setup(c,i),n&&n.apply(o,[a])})),a}(d.getBundle(s))},n(t,null,[{key:"inst",get:function(){return null==this._inst&&(this._inst=new t),this._inst}}]),t}())._inst=void 0,o._RF.pop()}}}));

System.register("chunks:///_virtual/UIWaiting.ts",["./rollupPluginModLoBabelHelpers.js","cc","./UIController.ts","./UIMgr.ts"],(function(n){var t,o,i,r;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy},function(n){i=n.UIController},function(n){r=n.UIMgr}],execute:function(){o._RF.push({},"0dda6mQNCdCo5GQ959qF/Db","UIWaiting",void 0);var e=[".","..","..."],a=null;n("UIWaiting",function(n){function o(){for(var t,o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(t=n.call.apply(n,[this].concat(i))||this)._contentStr="Loading",t}t(o,n);var i=o.prototype;return i.onCreated=function(){},o.show=function(n){return a||(a=r.inst.showUI(o)),a._contentStr=n||"Loading",a},o.hide=function(){a&&(a.close(),a=null)},i.onUpdate=function(){var n=this.layout;if(n.loadingIcon){var t=n.loadingIcon.eulerAngles,o=Date.now()/1e3*90;n.loadingIcon.setRotationFromEuler(t.x,t.y,o)}if(n.loadingTxt){var i=Math.floor(Date.now()/500)%3;n.loadingTxt.string=this._contentStr+e[i]}},i.onDispose=function(){a=null},o}(i));o._RF.pop()}}}));

System.register("chunks:///_virtual/URLUtils.ts",["cc"],(function(t){var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"bac65L5Qr9DOp7zav7JnYaI","URLUtils",void 0);t("URLUtils",function(){function t(){}return t.urlParse=function(t){var n,r,i={};if(!t)return i;for(var s=t,u=s.indexOf("?"),e=(s=s.substring(u+1)).split("&"),c=0;c<e.length;c++)(u=e[c].indexOf("="))>0&&(n=e[c].substring(0,u),r=e[c].substr(u+1),i[n]=r);return i},t}());n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});